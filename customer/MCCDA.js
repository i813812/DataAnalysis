"use strict";var zip,prgvers="7.23",dtmp=[],data=[],vdat=[],sdat=[],cntlbl=[],cntmin=[],cntmax=[],cntval=[],cntcum=[],header=[],filelist=[],dati=0,txtarea="",colsep="",ymin=0,ymax=0,xmin=0,xmax=0,xlen=0,pval=0,tickf="",gwidth=.75,hwidth=.25,sheight=.75,hsel="min",vmin="",vmax="",evdata="",start=!0,sspace=!1,slegend=!1,average=0,FWHM=0,slider=!1,tmptl="",dprev=!1,keyshift=!1,DAC=!1,selhdr="",hlegposx=.25,hlegposy=.85,mlegposx=0,mlegposy=-.35,slegposx=1,slegposy=1,hdrs=1,usefnam=!1,trex=!1,inparam={ustat:!0,selx1:"",selx2:"",selx3:"",selx4:"",selfx:"",sely1:"",sely2:"",sely3:"",sely4:"",selfc:"",vstack:"",xinpmin:"",hstinpmin:"",xinpmax:"",hstinpmax:"",xdtick:"",tround:!1,sround:300,cleand:!0,sshape:"linear",filter:"",selopt:"==",scnt:100,ytmin:"",ytmax:"",fact:1,grtype:"",logdis:!1,stsel:"ADD",opr:"AVG",maxpnt:1e4,dtsize:3,avgint:"",Gw:0,Hw:0,SGw:0,SHw:0,smooth:!1,showhist:!0,gtitle:"",xtitle:"",ytitle:"",cfonts:16,afonts:14,tfonts:10,datind:"",bgcolor:"#F4F4F4",chcolor:"#FEFEFE",fgcolor:"#444444",grcolor:"#DDDDDD",ptcolor:"#0000FF",p1color:"#20B2AA",p2color:"#F4D02F",p3color:"#FF0000",colsc:[[0,"#cccccc"],[0,"#ff9900"],[0,"#ff0000"],[0,"#660066"]]},ppt=0,parhst=[];parhst[0]=inparam;var excelwb,dtfrm=[[0,"YYYY-MM-DD",/(\d{4})[\/.-](\d{2})[\/.-](\d{2})/],[1,"DD-MM-YYYY",/(\d{2})[\/.-](\d{2})[\/.-](\d{4})/],[2,"YY-MM-DD",/(\d{2})[\/.-](\d{2})[\/.-](\d{2})/],[3,"DD-MM-YY",/(\d{2})[\/.-](\d{2})[\/.-](\d{2})/],[4,"YYYY-DD-MM",/(\d{4})[\/.-](\d{2})[\/.-](\d{2})/],[5,"MM-DD-YYYY",/(\d{2})[\/.-](\d{2})[\/.-](\d{4})/],[6,"YY-DD-MM",/(\d{2})[\/.-](\d{2})[\/.-](\d{2})/],[7,"MM-DD-YY",/(\d{2})[\/.-](\d{2})[\/.-](\d{2})/]],hdrpos=0,decpnt=".",delim=[[0,","],[0,";"],[0,"|"],[0,"\t"],[0,"/"]],detect=!0,wait=!1,init=!0,maxys=0,infile=[],prephd=!0,textarea="",tplclick=0,hstmin="",hstmax="",lnsize=1,lntype="solid",chtype="scatter",chmode="markers",stmode="group",filmod="",sgroup0="",sgroup1="",sgroup2="",sgroup3="",filecnt=0,fname="",upt=0,p0=0,p1=0,p2=0,pb=0,displaymode="",autohide=!1,impel=null,previewstyle=!1,mainstyle=!1;function setData(t,e){try{localStorage.setItem(t,escape(e))}catch(t){}}function perfnow(){var t=performance.now();return console.log("Time: "+t),t}function getData(t){var e;try{e=localStorage.getItem(t)}catch(t){}return null===e&&(e=""),unescape(e)}function loadhist(){addhist();var t=getData("DataAnalysis"),e=JSON.parse(t);parhst[ppt]=e,parhst[ppt].Gw=0,parameters(),graphic()}function loaddefault(){var t=getData("Default");if(""!=t){var e=JSON.parse(t);parhst[ppt].tround=e.tround,parhst[ppt].sround=e.sround,parhst[ppt].cleand=e.cleand,parhst[ppt].sshape=e.sshape,parhst[ppt].grtype=e.grtype,parhst[ppt].opr=e.opr,parhst[ppt].maxpnt=e.maxpnt,parhst[ppt].dtsize=e.dtsize,parhst[ppt].avgint=e.avgint,parhst[ppt].Gw=e.Gw,parhst[ppt].Hw=e.Hw,parhst[ppt].SGw=e.SGw,parhst[ppt].SHw=e.SHw,parhst[ppt].smooth=e.smooth,parhst[ppt].showhist=e.showhist,parhst[ppt].bgcolor=e.bgcolor,parhst[ppt].chcolor=e.chcolor,parhst[ppt].fgcolor=e.fgcolor,parhst[ppt].grcolor=e.grcolor,parhst[ppt].ptcolor=e.ptcolor,parhst[ppt].p1color=e.p1color,parhst[ppt].p2color=e.p2color,parhst[ppt].p3color=e.p3color,parhst[ppt].colsc=[[e.colsc[0][0],e.colsc[0][1]],[e.colsc[1][0],e.colsc[1][1]],[e.colsc[2][0],e.colsc[2][1]],[e.colsc[3][0],e.colsc[3][1]]]}}function dnlexport(){download("DataAnalysis.Export.xls",document.getElementById("IDtextarea").value)}function download(t,e){var a=document.createElement("a");a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),a.setAttribute("download",t),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}function download64(t,e){var a=document.createElement("a");a.setAttribute("href","data:application/zip;base64,"+e),a.setAttribute("download",t),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}function expset(){var t,e,a=parhst[ppt];if(keyshift){keyshift=!1,document.getElementById("IDEXP").innerHTML="Exp.",document.title="Export Data",zip=new JSZip;var p={id:"DataAnalysisContainer",config:a,ghead:header,gdata:data};if(t=JSON.stringify(p),document.title="add data to ZIP container",null==(e=filelist.length>0?prompt("Specify name of DataAnalysis container:",filelist[0].name):prompt("Specify name of DataAnalysis container:","DataAnalysisContainer")))return;""==e&&(e="DataAnalysisContainer"),e=e.replace(".dac",""),zip.file(e+".dac",t),zip.generateAsync({type:"base64",compression:"DEFLATE",compressionOptions:{level:5}},function(t){document.title="compress container "+t.percent.toFixed(2)+" % "}).then(function(t){download64(e+".dzip",t)})}else{if(t=JSON.stringify(a),null==(e=prompt("Specify name of configuration file:","*.json")))return;""==e&&(e="DataAnalysisConfig"),e.endsWith(".json")||(e+=".json"),download(e,t)}}function importconfig(){document.body.style.cursor="progress",addhist(),setTimeout(function(){var t=document.getElementById("IMPORT").files,e=new FileReader;t[0].name.endsWith(".dac")?(e.onload=function(){var t=e.result;if(t.includes("DataAnalysisContainer")){var a=JSON.parse(t);parhst[ppt]=a.config,data=a.gdata,header=a.ghead,document.body.removeChild(impel),parameters(),graphic()}},e.readAsText(t[0],"UTF-8")):(e.onload=function(){var t=e.result,a=JSON.parse(t);parhst[ppt]=a,parhst[ppt].Gw=0,parhst[ppt].xinpmin="",parhst[ppt].xinpmax="",document.body.removeChild(impel),parameters(),graphic()},e.readAsText(t[0],"UTF-8"))},25)}function impset(){var t;document.body.style.cursor="progress",document.title="Data Analysis - import configuration ... ",document.getElementById("IDDOT").className="dotred",document.getElementById("IDDOT").hidden=!0,document.getElementById("IDDOT").hidden=!1,keyshift?(keyshift=!1,document.getElementById("IDEXP").innerHTML="Exp.",t=parhst[ppt],JSON.stringify(t),(impel=document.createElement("input")).setAttribute("type","file"),impel.setAttribute("id","IMPORT"),impel.setAttribute("onchange","importconfig()"),impel.setAttribute("accept",".dac"),impel.setAttribute("hidden","true"),document.body.appendChild(impel),impel.click()):(t=parhst[ppt],JSON.stringify(t),(impel=document.createElement("input")).setAttribute("type","file"),impel.setAttribute("id","IMPORT"),impel.setAttribute("onchange","importconfig()"),impel.setAttribute("accept",".json"),impel.setAttribute("hidden","true"),document.body.appendChild(impel),impel.click())}function savehist(){var t=parhst[ppt];setData("DataAnalysis",JSON.stringify(t))}function savedefault(){var t=parhst[ppt];setData("Default",JSON.stringify(t))}function processFiles(){if(document.body.style.cursor="progress",filelist=document.getElementById("files").files,dprev=document.getElementById("IDcheckpreview").checked,document.title="loading data....",p0=perfnow(),DAC=!1,filelist[0].name.endsWith(".xlsx"))filelist[0].size>16777216?alert("Import Excel files is limited to 16MB \n\n Please open file with excel and copy & paste into input area"):(fname=filelist[0].name,document.getElementById("IDdata").innerHTML="",document.getElementById("IDbutupd").style.display="none",readexcel(filelist[0]));else{if(filelist[0].name.endsWith(".dzip"))return JSZip.loadAsync(filelist[0]).then(function(t){Object.keys(t.files).forEach(function(e){t.files[e].async("string").then(function(t){if(t.includes("DataAnalysisContainer")){var e=JSON.parse(t);parhst[ppt]=e.config,addhist(),data=e.gdata,header=e.ghead,DAC=!0,parameters()}})})}),void(document.body.style.cursor="default");data=[],txtarea="",infile=[],filecnt=0,prephd=!0,detect=!0;var t="",e="",a=0,p=0;for(p=0;p<filelist.length;p++)filelist[p].name.startsWith(".")||(""==e&&(e="."+filelist[p].name.split(".").pop(),fname=filelist[p].name),filelist[p].name.endsWith(e)&&(a+=1,t=filelist[p].name));for(filelist.length>1&&(fname+="..."+t),p=0;p<filelist.length;p++)filelist[p].name.startsWith(".")||filelist[p].name.endsWith(e)&&readfile(filelist[p],a,p+1);document.getElementById("IDdata").innerHTML="",document.getElementById("IDbutupd").style.display="none",document.title="Format Data completed",document.body.style.cursor="default"}}function parsexcel(){var t;p0=performance.now()-(p1-p0),t=excelwb.SheetNames.length>1?document.getElementById("IDexcelwb").value:0,fname+=" (Worksheet: "+excelwb.SheetNames[t]+")";var e="";try{e=XLSX.write(excelwb,{sheet:excelwb.SheetNames[t],type:"binary",bookType:"html"})}catch(t){}var a=new RegExp("","g");e=(e=e.replace(/(\r)/gm,"")).replace(/(\n)/gm,""),a=new RegExp(escapeRegExp("<style>")+".+"+escapeRegExp("</style>"),"g"),e=e.replace(a,""),a=new RegExp(escapeRegExp("<head>")+".+"+escapeRegExp("</head>"),"g"),e=e.replace(a,""),a=new RegExp(""+escapeRegExp("<td"),"g"),e=e.replace(a,"\n<td"),a=new RegExp(""+escapeRegExp("</tr>"),"g"),e=e.replace(a,"\n</tr>"),a=new RegExp(""+escapeRegExp("<tr"),"g");var p=(e=e.replace(a,"\n<tr")).split("\n"),n=new RegExp(escapeRegExp("<td t=")+'.+">',"g"),s=new RegExp(escapeRegExp("<tr")+'.+">',"g"),r=new RegExp(""+escapeRegExp("<td>"),"g"),o=escapeRegExp("<td>"),l=escapeRegExp(""),i=0;for(i=0;i<p.length;i++)p[i]=p[i].replace(n,o),p[i]=p[i].replace(s,l),p[i]=p[i].replace(r,l);for(e=[],i=0;i<p.length;i++)e+=p[i]+"\n";a=new RegExp(escapeRegExp("</td>")+"\n","g"),e=e.replace(a,"\t"),a=new RegExp(escapeRegExp("</tr>")+"\n","g"),e=e.replace(a,"\n"),a=new RegExp(escapeRegExp("<tr>")+"\n","g"),e=e.replace(a,"\n"),a=new RegExp("\n\n","g"),e=e.replace(a,"\n"),a=new RegExp(escapeRegExp("<html><body><table>")+"\n","g"),e=e.replace(a,""),a=new RegExp(escapeRegExp("</tr></table></body></html>")+".*","g"),e=e.replace(a,""),infile[0]={content:e,file:fname},process()}function readexcel(t){var e=new FileReader;e.onload=function(){var t=new Uint8Array(e.result);try{excelwb=XLSX.read(t,{type:"array"})}catch(t){}if(p1=perfnow(),excelwb.SheetNames.length>1){var a="";a+="<select id='IDexcelwb' onchange='parsexcel()'>\n",a+="<option value='-'> Select Worksheet </option>";for(var p=0;p<excelwb.SheetNames.length;p++)a+="<option value='"+p+"'> "+excelwb.SheetNames[p]+" </option>";a+="</select>",document.getElementById("IDload").innerHTML=SAPlogo(100,50)+" Excel File: "+filelist[0].name+" - "+a,document.getElementById("IDdetail").innerHTML="",document.getElementById("ID(C)").innerHTML=""}else parsexcel()},e.readAsArrayBuffer(filelist[0])}function charCount(t,e){for(var a=0,p=0;p<t.length;p++)t[p]==e&&a++;return a}function escapeRegExp(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function readfile(t,e,a){var p=new FileReader;p.onload=function(){if(infile[filecnt]={content:p.result,fname:t.name},infile[filecnt].content.includes("DataAnalysisContainer")){var a=JSON.parse(infile[filecnt].content);return parhst[ppt]=a.config,data=a.gdata,header=a.ghead,parameters(),void(DAC=!0)}(filecnt+=1)==e&&(process(),data.length<3&&(sspace||(document.getElementById("IDsep").value="S",detect=!0,prephd=!0,getsep(),process())))},p.readAsText(t,"UTF-8")}function update(){infile=[],dprev=document.getElementById("IDcheckpreview").checked,infile[0]={content:document.getElementById("IDtextarea").value,fname:""},""!=infile[0].content&&(document.getElementById("IDdata").style.display="none",document.getElementById("IDbutupd").style.display="none",prephd=!0,detect=!0,process(),0==data.length&&(document.getElementById("IDdata").style.display="inline-block",document.getElementById("IDbutupd").style.display="inline-block",alert("Please Review Data - no Header line ?")))}function prepexp(){document.getElementById("IDload").innerHTML=SAPlogo(100,50)+" ",document.getElementById("IDload").innerHTML+="<button onclick='copy()'>Copy</button> <button onclick='parameters()'>Graphic</button><br><br>",document.getElementById("IDload").innerHTML+="<textarea id='IDtextarea' rows='30' cols='300' style='tabSize:30; font-family:Courier; font-size:10px; color:#000044'  ></textarea><br><br>",document.title="Export Data",document.getElementById("IDhst").style.display="none",document.getElementById("IDgrp").style.display="none",document.getElementById("IDgraphic").style.display="none",txtarea=[];var t=0,e=0;for(t=0;t<header.length;t++)txtarea+=header[t][0]+"\t";for(txtarea+="\n",t=0;t<data.length;t++){for(e=0;e<data[t].length;e++)txtarea+=data[t][e]+"\t";txtarea+="\n"}document.getElementById("IDtextarea").value=txtarea,displaymode=""}function settitle(){addhist(),""==parhst[ppt].gtitle&&(parhst[ppt].gtitle=tmptl),parhst[ppt].gtitle=prompt("Enter Chart Title:",parhst[ppt].gtitle),parhst[ppt].xtitle=prompt("Enter Title for X-Axis:",parhst[ppt].xtitle),parhst[ppt].ytitle=prompt("Enter Title for Y-Axis:",parhst[ppt].ytitle),null==parhst[ppt].gtitle&&(parhst[ppt].gtitle=""),null==parhst[ppt].xtitle&&(parhst[ppt].xtitle=""),null==parhst[ppt].ytitle&&(parhst[ppt].ytitle=""),parameters(),graphic()}function expvdat(){document.getElementById("IDload").innerHTML=SAPlogo(100,50)+" ",document.getElementById("IDload").innerHTML+="<button onclick='copy()'>Copy</button> <button onclick='dnlexport()'>Download</button> <button onclick='parameters()'>Graphic</button><br><br>",document.getElementById("IDload").innerHTML+="<textarea id='IDtextarea' rows='30' cols='300' style='tabSize:30; font-family:Courier; font-size:10px; color:#000044'  ></textarea><br><br>",document.title="Export Data",document.getElementById("IDhst").style.display="none",document.getElementById("IDgrp").style.display="none",document.getElementById("IDgraphic").style.display="none",start=!0;var t=parseInt(parhst[ppt].sely1),e=parseInt(parhst[ppt].sely2),a=parseInt(parhst[ppt].sely3),p=parseInt(parhst[ppt].sely4),n=0;""!==parhst[ppt].sely1&&header[t][2]>n&&(n=header[t][2]),""!==parhst[ppt].sely2&&header[e][2]>n&&(n=header[t][2]),""!==parhst[ppt].sely3&&header[a][2]>n&&(n=header[t][2]),""!==parhst[ppt].sely4&&header[p][2]>n&&(n=header[t][2]),txtarea=[],txtarea="Index\tStack\tX-Value\tY1\tY2\tY3\tY4\tC\n";var s=0;for(s=0;s<vdat.length;s++)isNaN(vdat[s].y1)||(vdat[s].y1=vdat[s].y1.toPrecision(n)),isNaN(vdat[s].y2)||(vdat[s].y2=vdat[s].y2.toPrecision(n)),isNaN(vdat[s].y3)||(vdat[s].y3=vdat[s].y3.toPrecision(n)),isNaN(vdat[s].y4)||(vdat[s].y4=vdat[s].y4.toPrecision(n)),txtarea+=s+"\t"+vdat[s].s+"\t"+vdat[s].x+"\t"+vdat[s].y1+"\t"+vdat[s].y2+"\t"+vdat[s].y3+"\t"+vdat[s].y4+"\t"+vdat[s].c+"\n";document.getElementById("IDtextarea").value=txtarea,displaymode=""}function pad(t,e){var a="000000000000000"+t;return a.substr(a.length-e)}function identify(t,e=""){var a=t,p="",n=0,s=[],r="Date\tTime\tResp (ms)\n",o=[],l="",i="",d=!1;if(t.includes("MIME-Version")){var c=new RegExp("","g");a=(a=a.replace(/(\r)/gm,"")).replace(/(\n)/gm,""),c=new RegExp(escapeRegExp("<style>")+".+"+escapeRegExp("</style>"),"g"),a=a.replace(c,""),c=new RegExp(escapeRegExp("<head>")+".+"+escapeRegExp("</head>"),"g"),a=a.replace(c,""),c=new RegExp(""+escapeRegExp("<td"),"g"),a=a.replace(c,"\n<td"),c=new RegExp(""+escapeRegExp("</tr>"),"g"),a=a.replace(c,"\n</tr>"),c=new RegExp(""+escapeRegExp("<tr"),"g"),s=(a=a.replace(c,"\n<tr")).split("\n");var h=new RegExp(escapeRegExp("<td class")+'.+">',"g"),m=new RegExp(escapeRegExp("<tr")+'.+">',"g"),u=new RegExp(""+escapeRegExp("<td>"),"g"),y=escapeRegExp("<td>"),g=escapeRegExp("");for(n=0;n<s.length;n++)s[n]=s[n].replace(h,y),s[n]=s[n].replace(m,g),s[n]=s[n].replace(u,"");for(a=[],n=1;n<s.length;n++)a+=s[n]+"\n";return c=new RegExp(escapeRegExp("</td>")+"\n","g"),a=a.replace(c,"\t"),c=new RegExp(escapeRegExp("</tr>")+"\n\n","g"),a=a.replace(c,"\n"),c=new RegExp(escapeRegExp("</tr></table></body></html>")+".+","g"),a=a.replace(c,"")}if(t.includes("swap")&&t.includes("r b w")&&t.includes("kthr")){for(void 0===identify.inpd&&(identify.inpd=""),s=t.split("\n"),p="",d=!1,sspace=!0,n=0;n<s.length;n++)if(0==d){if(s[n].includes("started")){switch((o=s[n].split(" "))[1]){case"Jan":l="01";break;case"Feb":l="02";break;case"Mar":l="03";break;case"Apr":l="04";break;case"May":l="05";break;case"Jun":l="06";break;case"Jul":l="07";break;case"Aug":l="08";break;case"Sep":l="09";break;case"Oct":l="10";break;case"Nov":l="11";break;case"Dec":l="12"}p=o[6]+"-"+l+"-"+pad(o[3],2)}if(s[n].includes("r b w")){if(a=s[n],""==p)for(;;){if(identify.inpd=p=prompt("Enter Date (YYYY-MM-DD) - File: "+e,identify.inpd),new RegExp(/(\d{4})-(\d{2})-(\d{2})/).test(p))break}a=(a=(a=(a=(a=(a=(a=(a=(a="Date Time "+a.replace(/(\d\d:\d\d:\d\d)\s/,"")+"\n").replace("r b w ","Threads.queued Thread.blocked LWPs.swapped ")).replace("re  mf ","Pages.recl. Page.faults ")).replace("swap ","Av.Swap.Space ")).replace("free ","FreeList ")).replace("pi po fr ","kB(in) kB(out) kB(freed) ")).replace("de sr ","Ant.mem Pages.scanned ")).replace("in   sy   cs ","Inter.p.sec Sys.Calls Cont.switch ")).replace("us sy id","CPU.Usr CPU.Sys CPU.Idl"),d=!0}}else if(s[n].includes("r b w"));else{if((o=s[n].split(" ",3))[0]<i){var v=new Date(p);v.setDate(v.getDate()+1);var f=v.getUTCMonth()+1,x=v.getUTCDate();p=v.getUTCFullYear()+"-"+pad(f,2)+"-"+pad(x,2)}a+=p+" "+s[n]+"\n",i=o[0]}return a}if(t.includes("AAA")&&t.includes("nmon")){a=a.split("\n");var I="",D="",b="",E="",k=0,w=[],B=1,M=[],T=0,S=[],A=0,N=[],H=0,C=[],F=0,L=[],R=0,P=[],z=0;for(w[0]="Host\tMachine\tProcessor\tTime\tDate\t",n=0;n<a.length;n++)switch((s=a[n].split(","))[0]){case"CPU_ALL":for(M[T]="",k=0;k<s.length;k++)k<2||(0==T&&(s[k]="CPU "+s[k]),M[T]+=s[k]+"\t");T+=1;break;case"MEM":for(S[A]="",k=0;k<s.length;k++)s[k]=s[k].replace("Size of the Compressed pool(MB)","Cmpr.Pool(MB)"),s[k]=s[k].replace("Size of true memory(MB)","True Mem.(MB)"),s[k]=s[k].replace("Expanded memory size(MB)","Exp.Mem.(MB)"),s[k]=s[k].replace("Size of the Uncompressed pool(MB)","UnCmpr.Pool(MB)"),k<2||k>7||(0==A&&(s[k]="MEM "+s[k]),S[A]+=s[k]+"\t");A+=1;break;case"MEMNEW":for(N[H]="",k=0;k<s.length;k++)s[k]=s[k].replace("Compressed Pool","Cmpr.Pool"),k<2||k>7||(0==H&&(s[k]="MEM "+s[k]),N[H]+=s[k]+"\t");H+=1;break;case"PROC":for(C[F]="",k=0;k<s.length;k++)k<2||k>7||(0==F&&(s[k]="PROC "+s[k]),C[F]+=s[k]+"\t");F+=1;break;case"LPAR":for(L[R]="",k=0;k<s.length;k++)k<2||k>12||(0==R&&(s[k]="LPAR "+s[k]),L[R]+=s[k]+"\t");R+=1;break;case"PAGE":for(P[z]="",k=0;k<s.length;k++)k<2||k>4||(0==z&&(s[k]="PAGE "+s[k]),P[z]+=s[k]+"\t");z+=1;break;case"AAA":"host"==s[1]&&(D=s[2]);break;case"BBBP":if("lsconf"==s[2]&&s.length>3){var G=s[3].replace(/\"/g,"").split(":");"System Model"==G[0]&&(E=G[1]+" "+s[4].replace(/\"/g,"")),"Machine Serial Number"==G[0]&&(E+=" ("+G[1].trim()+")"),"Processor Implementation Mode"==G[0]&&(b=G[1]),"Number Of Processors"==G[0]&&(b+=" (# "+G[1]+")"),"Processor Clock Speed"==G[0]&&(b+=" - "+G[1])}break;case"ZZZZ":for(w[B]=D+"\t",w[B]+=E+"\t",w[B]+=b+"\t",k=0;k<s.length;k++)if(!(k<2)){if(3==k){var X=s[k].split("-");switch(X[1]){case"JAN":l="01";break;case"FEB":l="02";break;case"MAR":l="03";break;case"APR":l="04";break;case"MAY":l="05";break;case"JUN":l="06";break;case"JUL":l="07";break;case"AUG":l="08";break;case"SEP":l="09";break;case"OCT":l="10";break;case"NOV":l="11";break;case"DEC":l="12"}s[k]=X[2]+"."+l+"."+X[0]}w[B]+=s[k]+"\t"}B+=1}for(n=0;n<M.length;n++)I+=w[n]+M[n]+S[n]+N[n]+C[n]+L[n]+P[n]+"\n";return I}if(!t.startsWith("Linux")){if(t.includes("host;tenant;time;searchCount")){for(a=a.split("\n"),n=0;n<a.length;n++)r+=" "+a[n]+"\n";return parhst[ppt].selx1=1,trex=!0,colsep=";",r}if(t.includes("connect to server o.k.")){for(a=(a=(a=(a=(a=(a=a.replace(/(\r\n\r\n|\n\n|\r\r|\r\n)/gm,"\n")).replace(/(\r)/gm,"\n")).replace(/( ms\n)/gm,"\n")).replace(/(connect to server o.k.\n)/gm,"")).replace(/( 20\d\d)\n/gm,"$1")).split("\n"),n=0;n<a.length;n++)if(""!=a[n]){switch(/\w\w\w \w\w\w /.test(a[n])?(p=(s=a[n].split(" "))[0]+" "+s[1]+" "+s[2]+" "+s[3]+" "+s[4],0):(a[n]=p+a[n],1),a[n]=a[n].replace(/ +/g," "),a[n]=a[n].replace(/ /g,"|"),l="",(o=a[n].split("|"))[1]){case"Jan":l="01";break;case"Feb":l="02";break;case"Mar":l="03";break;case"Apr":l="04";break;case"May":l="05";break;case"Jun":l="06";break;case"Jul":l="07";break;case"Aug":l="08";break;case"Sep":l="09";break;case"Oct":l="10";break;case"Nov":l="11";break;case"Dec":l="12";break;default:l=o[1],parhst[ppt].grtype="scatter"}parseFloat(o[6])>0&&(r+=o[4]+"."+l+"."+pad(o[2],2)+"\t"+o[3]+"\t"+o[6],r+="\n")}return r}return t}void 0===identify.inpd&&(identify.inpd=""),s=(s=(s=(s=(s=t).replace(/ /g,"\t")).replace(/\t+/g,"\t")).replace(/\r\n/g,"\n")).split("\n"),l=p=i="",d=!1;var Y=new RegExp(/(\d{2})\/(\d{2})\/(\d{4})/),O=new RegExp(/(\d{2}):(\d{2}):(\d{2})/),U=s[0].split("\t"),K=s[2].split("\t");if(s[0].includes("Linux")&&""==s[1]&&Y.test(U[3])&&O.test(K[0])){var W=U[3].split("/");for(p=W[2]+"-"+W[0]+"-"+W[1],s[2]="Date\tTime\t"+s[2].replace(/(\d\d:\d\d:\d\d)\s/,"").replace(/(AM\t)/,"").replace(/(PM\t)/,""),n=3;n<s.length;n++){s[n].includes("Linux")&&(p=(W=(U=s[n].split("\t"))[3].split("/"))[2]+"-"+W[0]+"-"+W[1]);var V=(o=s[n].split("\t"))[0].split(":"),J=parseInt(V[0]),_=V[1],j=V[2];"PM"==o[1]&&(J+=12),a=p+"\t"+(i=pad(J,2)+":"+_+":"+j)+"\t";for(var Z=2;Z<o.length;Z++)a+=o[Z]+"\t";s[n]=a}for(a="",n=2;n<s.length;n++)a=a+s[n]+"\n";return a=a.replace(/\t\n/g,"\n")}}function findhdr(t){var e=t.split(" "),a=0,p=0;for(p=1;p<header.length;p++){var n=!0,s=header[p][0].replace(/ /g,"").toLowerCase();for(a=0;a<e.length;a++)n=n&&s.includes(e[a].toLowerCase());if(n)return hdrpos=p,!0}return!1}function checkhdr(){parhst[ppt].selx1=1,hdrpos=0,findhdr("CPU usr")||findhdr("cpu user")||findhdr("%user")||findhdr("User%")||findhdr("cpuUsed")||findhdr("USR_TOTAL")?(parhst[ppt].colsc[0][0]=65,parhst[ppt].colsc[1][0]=80,parhst[ppt].colsc[2][0]=90,parhst[ppt].sely1=hdrpos,parhst[ppt].ytmin="0",parhst[ppt].ytmax="100",findhdr("cpu sys")&&(parhst[ppt].sely2=hdrpos),findhdr("sys%")&&(parhst[ppt].sely2=hdrpos),findhdr("%system")&&(parhst[ppt].sely2=hdrpos),findhdr("SYS_TOTAL")&&(parhst[ppt].sely2=hdrpos)):findhdr("cpu")?(parhst[ppt].colsc[0][0]=65,parhst[ppt].colsc[1][0]=80,parhst[ppt].colsc[2][0]=90,parhst[ppt].sely1=hdrpos,parhst[ppt].ytmin="0",parhst[ppt].ytmax="100"):findhdr("memory")?(parhst[ppt].colsc[0][0]=0,parhst[ppt].colsc[1][0]=0,parhst[ppt].colsc[2][0]=0,parhst[ppt].sely1=hdrpos):findhdr("mem")?(parhst[ppt].colsc[0][0]=0,parhst[ppt].colsc[1][0]=0,parhst[ppt].colsc[2][0]=0,parhst[ppt].sely1=hdrpos):findhdr("E. Acc DB")?(parhst[ppt].colsc[0][0]=100,parhst[ppt].colsc[1][0]=155,parhst[ppt].colsc[2][0]=200,parhst[ppt].grtype="scatter",parhst[ppt].sely1=hdrpos):findhdr("Resp (ms)")&&(parhst[ppt].colsc[0][0]=.5,parhst[ppt].colsc[1][0]=.7,parhst[ppt].colsc[2][0]=1.2,parhst[ppt].sely1=4)}function reprocess(){DAC&&location.reload(),detect=!0,prephd=!0,start=!0,header=[],data=[],displaymode="",document.getElementById("IDgraphic").style.display="none",document.getElementById("IDhst").style.display="none",document.getElementById("IDgrp").style.display="none",dprev=!0,addhist(),parhst[ppt].selx1=parhst[ppt].selx2=parhst[ppt].selx3=parhst[ppt].selx4="",parhst[ppt].sely1=parhst[ppt].sely2=parhst[ppt].sely3=parhst[ppt].sely4="",process()}function process(){document.title="data loaded, preparing preview",document.body.style.cursor="progress",txtarea="";var t=0,e=0,a=0,p=0,n=(new RegExp(""),0),s=[],r="",o="";for(e=0;e<infile.length;e++){var l=1;if(infile[e].content=identify(infile[e].content,infile[e].fname),sspace&&(infile[e].content=infile[e].content.replace(/ +/g,"\t"),colsep="\t"),filelist.length>0&&filelist[0].name.includes(".csv"))s=CSVToArray(infile[e].content,colsep),r="\t";else if(s=infile[e].content.split("\n"),""==colsep){if(detect){for(a=0;a<delim.length;a++)for(delim[a][0]=0,p=0;p<s.length&&(new RegExp(""+delim[a][1],"g"),delim[a][0]+=charCount(s[p],delim[a][1]),20!=p);p++);detect=!1}delim.sort((t,e)=>e[0]-t[0]),r=delim[0][1]}else r=colsep;var i=!0,d=0;for(a=0;a<s.length&&((n=charCount(s[a],r))>d&&(d=n),!(a>20));a++);var c=new RegExp("^"+escapeRegExp(r)+"\\s+"+escapeRegExp(r),"g"),h=new RegExp("^"+escapeRegExp(r),"g"),m=new RegExp(escapeRegExp(r)+"$","g"),u=new RegExp("s*"+escapeRegExp(r)+"s*$","g"),y=new RegExp(""+escapeRegExp(r),"g"),g=pad(e,1+Math.trunc(Math.log10(infile.length+1)));for(a=0;a<s.length;a++){var v=s[a];if("---"!=(v=v.substring(1,4))&&""!=s[a]){if(i){if(prephd){if((t=charCount(s[a],r))<d)continue;s[a]=s[a].replace(c,""),s[a]=s[a].replace(h,""),s[a]=s[a].replace(m,""),s[a]="File"+r+"Index"+r+s[a],o=s[a].slice(Math.trunc(s[a].length/2));var f=s[a].split(r);for(p=0;p<f.length;p++)header[p]=[f[p].trim(),""];for(p=0;p<header.length;p++)""!=header[p][0]&&isNaN(header[p][0])||(header[p][0]="Key"+p);s[a]=s[a].replace(y,"\t"),d=charCount(s[a],"\t"),txtarea+=s[a]+"\n",prephd=!1,checkhdr()}i=!1}if(!i){if(""==header[1][0])break;if(s[a].includes(o))continue;if("."==decpnt?","!=r&&(s[a]=s[a].replace(/,/g,"")):(s[a]=s[a].replace(/\./g,""),s[a]=s[a].replace(/,/g,".")),charCount(s[a],r)!=t)continue;s[a]=s[a].replace(c,""),s[a]=s[a].replace(h,""),s[a]=s[a].replace(u,""),s[a]=s[a].replace(m,"");var x="I"+pad(l,1+Math.trunc(Math.log10(infile.length*s.length+1)));s[a]=usefnam?""+infile[e].fname+r+x+r+s[a]:"F"+g+r+x+r+s[a],s[a]=s[a].replace(/ /g,"");for(var I=charCount(s[a],r);I<d;I++)s[a]=s[a]+r;var D=s[a].split(r);dtmp=[];for(var b=0;b<D.length;b++)dtmp[b]=""+D[b];data.push(""),data[data.length-1]=dtmp.slice(0),l++}}}}if(s=[],!(data.length<3)){if(trex){for(p=4;p<header.length;p++)for(a=0;a<data.length;a++)"<"==data[a][p][0]?(data[a][p]=parseInt(data[a][p].substr(1)),data[a][p]=parseInt(data[a-1][p])-data[a][p]):">"==data[a][p][0]?(data[a][p]=parseInt(data[a][p].substr(1)),data[a][p]=parseInt(data[a-1][p])+data[a][p]):""==data[a][p]?data[a][p]=parseInt(data[a-1][p]):data[a][p]=parseInt(data[a][p]);for(header.splice(4,0,["Date","d"]),a=0;a<data.length;a++)data[a].splice(4,0,"");for(a=0;a<data.length;a++){var E=new Date(0);E.setUTCSeconds(data[a][5]);var k=E.getMonth()+1,w=E.getDay(),B=E.getFullYear(),M=E.getHours(),T=E.getMinutes(),S=E.getSeconds();data[a][4]=B+"-"+pad(k,2)+"-"+pad(w,2),data[a][5]=pad(M,2)+":"+pad(T,2)+":"+pad(S,2)}checkhdr()}new RegExp("");var A=!1;if(""==parhst[ppt].datind)for(p=0;p<data.length;p++){for(var N=0;N<data[p].length;N++){for(var H=0;H<dtfrm.length;H++)if(dtfrm[H][2].test(data[p][N])){A=!0,parhst[ppt].datind=""+H;break}if(A)break}if(10==p||A)break}headertyp();var C="",F="";for(p=0;p<header.length;p++)if("d"==header[p][1]){C=p;break}for(p=0;p<header.length;p++)if("t"==header[p][1]){F=p;break}if(""!=C&&""!=F?(parhst[ppt].selx1=C,parhst[ppt].selx2=F):""!=C&&""==F?parhst[ppt].selx1=C:""==C&&""!=F&&(parhst[ppt].selx1=F),""==parhst[ppt].sely1)for(p=2;p<header.length;p++)if("n"==header[p][1]){parhst[ppt].sely1=p;break}dprev?preview():parameters()}}function headertyp(){var t=0,e=0;new RegExp("");for(t=0;t<header.length;t++){var a=!0;for(e=0;e<data.length;e++){if(isNaN(data[e][t])){a=!1;break}if(e>20)break}header[t][1]=a?"n":"-"}for(t=0;t<header.length;t++){var p=!1,n=!1;for(e=0;e<data.length;e++){if(/(\d{1,2}):(\d{2}):(\d{2})/.test(data[e][t]))p=!0;else{if(!/(\d{1,2}):(\d{2})/.test(data[e][t])){p=!1;break}p=!0,n=!0}if(e>20)break}if(n)for(e=0;e<data.length;e++)data[e][t]=data[e][t]+":00";p&&(header[t][1]="t")}for(t=0;t<header.length;t++){var s=!1;for(e=0;e<data.length;e++){if(/(\d{4})[\/.-](\d{2})[\/.-](\d{2})/.test(data[e][t])){s=!0;break}if(/(\d{2})[\/.-](\d{2})[\/.-](\d{4})/.test(data[e][t])){s=!0;break}if(/(\d{2})[\/.-](\d{2})[\/.-](\d{2})/.test(data[e][t])){s=!0;break}if(e>20)break}s&&(header[t][1]="d")}for(t=0;t<header.length;t++)for(header[t][2]=0,e=0;e<100;e++){var r=Math.trunc(Math.random()*(data.length-1));data[r][t].length>header[t][2]&&(header[t][2]=data[r][t].length)}}function preview(){var t=0,e=0,a="";for(a+="<select id='IDDTF' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='seldatfrm()'>\n",t=0;t<dtfrm.length;t++)t==parhst[ppt].datind?a+="<option value='"+dtfrm[t][0]+"' selected > "+dtfrm[t][1]+" </option>":a+="<option value='"+dtfrm[t][0]+"'> "+dtfrm[t][1]+" </option>";if(a+="</select>",!previewstyle){var p=document.createElement("style");p.innerHTML="",p.id="STYLEpreview",p.innerHTML+=" td { padding-right: 0.2em; padding-left: 0.2em; }",document.body.appendChild(p),previewstyle=!0}var n="<small>Review data, if required edit header description(s), then press <i><b>Graphic</b></i> button to display the histogram & scatterplot - Select Date Format: "+a+"  - Use: ";for(n+=usefnam?"<button onclick='toggleusefnam()' title='Toggle File Name / File count' >File Name</button>":"<button onclick='toggleusefnam()' title='Toggle File Name / File count' >File Count</button>",n+="</small><br>",n+="<font color='#444488' style='font-size: 10px;'>",n+="<table><tr>",t=0;t<header.length;t++)""!=header[t[0]]&&(n+="<td><input id='IDhdr"+t+"' style='font-size:12px;' font-weight:bold;  onblur='bhdr()' onfocus='shdr()' onchange='readhdr()' size = '8' type='text' name='hdr' value='"+header[t][0]+"'></td>");for(n+="</tr>",t=0;t<data.length;t++){for(n+="<tr>",e=0;e<data[t].length;e++)n+="<td>"+data[t][e]+"</td>";if(t>25)break;n+="</tr>"}for(n+="<tr><td colspan="+data[t].length+"> ... </td></tr>",t=data.length-5;t<data.length;t++){for(n+="<tr>",e=0;e<data[t].length;e++)n+="<td>"+data[t][e]+"</td>";n+="</tr>"}n+="</table>",n+="</font>",document.getElementById("IDoutput").innerHTML="<button id='IDbutret' style='color:gray' onclick='goback()'><i>go back</i></button>",document.getElementById("IDoutput").innerHTML+="<button id='IDgrpic' onclick='parameters()'><b>Graphic</b></button><br><br>",document.getElementById("IDpreview").innerHTML=n,document.getElementById("IDpreview").innerHTML+="<div style='overflow: hidden; position: relative;'><div style='position: absolute; height: 10px; width: 10px;  right: -100px; top: -100px;'><textarea id='IDexport' rows='1' cols='1' style='tabSize:30; font-family:Courier; font-size:10px; color:#000044'  ></textarea></div><div>",document.getElementById("IDpreview").innerHTML+="<br><button onclick='exppre()'>Copy to Clipboard</button>",document.getElementById("IDpreview").innerHTML+=" <small>   replace: </small><input id='IDFIND' size='30' >",document.getElementById("IDpreview").innerHTML+=" <small>with: </small><input id='IDREPL' size='30' >",document.getElementById("IDpreview").innerHTML+="<button onclick='findrepl()' title='find and replace in non-numeric fields' >Replace</button>",document.getElementById("IDpreview").innerHTML+="<button onclick='splithdr()' title='Split Column' >Split</button>",document.getElementById("IDpreview").innerHTML+="<div id='IDdel' style='display: inline-block;'></div><br><br> ",document.getElementById("IDload").innerHTML=SAPlogo(100,50),document.getElementById("ID(C)").innerHTML="";var s=((p1=perfnow())-p0).toFixed(2);document.getElementById("IDdetail").innerHTML=" <small> Runtime: "+s+" ms  -- "+data.length+" records loaded </small>",document.title="data preview ready",document.body.style.cursor="default"}function toggleusefnam(){usefnam=!usefnam,detect=!0,prephd=!0,start=!0,header=[],data=[],displaymode="",process()}function shdr(t){var e=event.target.id;selhdr=parseInt(e.replace("IDhdr","")),document.getElementById("IDdel").innerHTML="<button onclick='dtdelete(event)' title='Delete Selected Values' >Delete Values</button>"}function bhdr(t){setTimeout(function(){document.activeElement.id.includes("IDhdr")||(document.getElementById("IDdel").innerHTML="",selhdr="")},100)}function findrepl(){for(var t=document.getElementById("IDFIND").value,e=document.getElementById("IDREPL").value,a=0;a<data.length;a++)for(var p=0;p<data[a].length;p++)isNaN(data[a][p])&&(data[a][p]=data[a][p].replace(t,e));preview()}function exppre(){var t=[],e=0,a=0;for(e=0;e<header.length;e++)t+=header[e][0]+"\t";for(t+="\n",e=0;e<data.length;e++){for(a=0;a<data[e].length;a++)t+=data[e][a]+"\t";t+="\n"}document.getElementById("IDexport").value=t,alert("Data will be selected - please wait a few seconds... "),document.title="Data export in progress - please be patient... ",(textarea=document.getElementById("IDexport")).select(),document.execCommand("copy"),alert("Data copied to clipboard - use Ctrl-V to paste"),document.title="Data export successfull",document.getElementById("IDexport").remove()}function seldatfrm(){parhst[ppt].datind=document.getElementById("IDDTF").value}function goback(){"function"==typeof BuildInit?(header=[],data=[],infile=[],txtarea="",displaymode="",filecnt=0,prephd=!0,detect=!0,start=!0,BuildInit()):location.reload()}function readhdr(){for(var t=0;t<header.length;t++){var e="IDhdr"+t;header[t][0]=document.getElementById(e).value}}function dtdelete(t){var e,a="",p=0,n=0;if(""!=selhdr){for(e=parseInt(selhdr);;){if(null==(a=prompt("Specify Value to delete for column\n\n"+header[e][0]+" = ","")))return;for(n=0,p=0;p<data.length;p++)data[p][e]==a&&(n+=1);if(0!=n)break;alert("no matching records found")}!0===confirm("Found "+n+" records - continue deleting those records?")?(p0=perfnow(),document.title="deleting records ... ",document.getElementById("IDpreview").innerHTML="",document.getElementById("IDdetail").innerHTML="",document.getElementById("ID(C)").innerHTML="",document.body.style.cursor="progress",setTimeout(function(){for(var t=0;data[t][e]==a?(data[t]=data[data.length-1],data.pop()):t+=1,!(t>data.length-1););var p="";for(t=2;t<header.length;t++)p+=header[t][0],t<header.length-1&&(p+="\t");for(p+="\n",t=0;t<data.length;t++){for(var n=2;n<data[t].length;n++)p+=data[t][n],n<data[t].length-1&&(p+="\t");p+="\n"}(infile=[])[0]={content:p,fname:""},detect=!0,prephd=!0,start=!0,header=[],data=[],displaymode="",document.getElementById("IDgraphic").style.display="none",document.getElementById("IDhst").style.display="none",document.getElementById("IDgrp").style.display="none",process()},25)):alert("deletion canceled")}}function splithdr(){for(var t="",e=0,a="",p=0,n=0;;){for(;;){if(""==(t=prompt("Specify column number to split (column '"+header[2][0]+"' = 2):",""))||null==t)return;if((e=parseInt(t))>1&&e<header.length)break}for(;;){if(a=prompt("Split column ("+header[e][0]+") - specify position (from left):",""),p=parseInt(a),""==a||null==a)return;if(p>0)break}if(n=data[0][e].length,confirm("Confirm Result: "+data[0][e].substring(0,p)+" -- "+data[0][e].substring(p,n)+" "))break}if(!((e+=1)<1||""==t||p<1||""==a)){var s=["","",0];s[0]+=header[e-1][0],s[1]+=header[e-1][1],s[2]+=header[e-1][2],header.splice(e,0,s),header[e][0]="Hdr "+hdrs,hdrs+=1,header[e][2]=n-p;for(var r=0;r<data.length;r++)data[r].splice(e,0,""),n=data[r][e-1].length,data[r][e]=data[r][e-1].substring(p,n),data[r][e-1]=data[r][e-1].substring(0,p);headertyp();var o="";for(r=2;r<header.length;r++)o+=header[r][0],r<header.length-1&&(o+="\t");for(o+="\n",r=0;r<data.length;r++){for(var l=2;l<data[r].length;l++)o+=data[r][l],l<data[r].length-1&&(o+="\t");o+="\n"}(infile=[])[0]={content:o,fname:""},detect=!0,prephd=!0,start=!0,header=[],data=[],displaymode="",document.getElementById("IDgraphic").style.display="none",document.getElementById("IDhst").style.display="none",document.getElementById("IDgrp").style.display="none",process()}}function SAPlogo(t,e){var a="";return a+="<svg ",a+='\t xmlns:svg="http://www.w3.org/2000/svg" ',a+='\t xmlns="http://www.w3.org/2000/svg" ',a+='\t xmlns:xlink="http://www.w3.org/1999/xlink" ',a+='\t version="1.1" ',a+='\t width="'+t+'px" ',a+='\t height="'+e+'px" ',a+='\t viewBox="1 -2 92 47" ',a+='\t id="svg5220"> ',a+="\t<defs ",a+='\t\t id="defs5222"> ',a+="\t\t<linearGradient ",a+='\t\t\t x1="0" ',a+='\t\t\t y1="0" ',a+='\t\t\t x2="0.9572" ',a+='\t\t\t y2="0" ',a+='\t\t\t id="linearGradient3048" ',a+='\t\t\t gradientUnits="userSpaceOnUse" ',a+='\t\t\t gradientTransform="matrix(0,-37.1015,37.1015,0,69.9034,70.5065)" ',a+='\t\t\t spreadMethod="pad"> ',a+="\t\t\t<stop ",a+='\t\t\t   id="stop3050" ',a+='\t\t\t   style="stop-color:#00b8f1;stop-opacity:1" ',a+='\t\t\t   offset="0" /> ',a+="\t\t\t<stop ",a+='\t\t\t   id="stop3052" ',a+='\t\t\t   style="stop-color:#06a5e5;stop-opacity:1" ',a+='\t\t\t   offset="0.2198" /> ',a+="\t\t\t<stop ",a+='\t\t\t   id="stop3054" ',a+='\t\t\t   style="stop-color:#06a5e5;stop-opacity:1" ',a+='\t\t\t   offset="0.2198" /> ',a+="\t\t\t<stop ",a+='\t\t\t   id="stop3056" ',a+='\t\t\t   style="stop-color:#1870c5;stop-opacity:1" ',a+='\t\t\t   offset="0.7943" /> ',a+="\t\t\t<stop ",a+='\t\t\t   id="stop3058" ',a+='\t\t\t   style="stop-color:#1d61bc;stop-opacity:1" ',a+='\t\t\t   offset="1" /> ',a+="\t\t</linearGradient> ",a+="\t\t<linearGradient ",a+='\t\t\t x1="0" ',a+='\t\t\t y1="0" ',a+='\t\t\t x2="0.9572" ',a+='\t\t\t y2="0" ',a+='\t\t\t id="linearGradient5318" ',a+='\t\t\t xlink:href="#linearGradient3048" ',a+='\t\t\t gradientUnits="userSpaceOnUse" ',a+='\t\t\t gradientTransform="matrix(0,-37.1015,37.1015,0,69.9034,70.5065)" ',a+='\t\t\t spreadMethod="pad" /> ',a+="\t\t<linearGradient ",a+='\t\t\t x1="0" ',a+='\t\t\t y1="0" ',a+='\t\t\t x2="0.9572" ',a+='\t\t\t y2="0" ',a+='\t\t\t id="linearGradient5323" ',a+='\t\t\t xlink:href="#linearGradient3048" ',a+='\t\t\t gradientUnits="userSpaceOnUse" ',a+='\t\t\t gradientTransform="matrix(0,-37.1015,37.1015,0,69.9034,70.5065)" ',a+='\t\t\t spreadMethod="pad" /> ',a+="\t\t<linearGradient ",a+='\t\t\t x1="0" ',a+='\t\t\t y1="0" ',a+='\t\t\t x2="0.9572" ',a+='\t\t\t y2="0" ',a+='\t\t\t id="linearGradient5331" ',a+='\t\t\t xlink:href="#linearGradient3048" ',a+='\t\t\t gradientUnits="userSpaceOnUse" ',a+='\t\t\t gradientTransform="matrix(0,-37.1015,37.1015,0,69.9034,70.5065)" ',a+='\t\t\t spreadMethod="pad" /> ',a+="\t\t<linearGradient ",a+='\t\t\t x1="0" ',a+='\t\t\t y1="0" ',a+='\t\t\t x2="0.9572" ',a+='\t\t\t y2="0" ',a+='\t\t\t id="linearGradient5334" ',a+='\t\t\t xlink:href="#linearGradient3048" ',a+='\t\t\t gradientUnits="userSpaceOnUse" ',a+='\t\t\t gradientTransform="matrix(0,46.3769,46.3769,0,44.859,0.024)" ',a+='\t\t\t spreadMethod="pad" /> ',a+="\t</defs> ",a+="\t<path ",a+='\t\t d="m 0,0 0,44.415 45.371,0 44.41,-44.41 0,0 -89.781,0 z" ',a+='\t\t id="path3060" ',a+='\t\t style="fill:url(#linearGradient5334);fill-opacity:1;stroke:none" /> ',a+="\t<path ",a+='\t\t d="m 57.4688,39.875 0,3.3125 0.5,0 0,-1.4375 0.5624,0 0.9063,1.4375 0.5625,0 -0.9688,-1.4375 c 0.4841,-0.06 0.875,-0.3415 0.875,-0.9375 0,-0.653 -0.3996,-0.9375 -1.1874,-0.9375 l -1.25,0 z m 0.5,0.4375 0.6874,0 c 0.3381,0 0.7188,0.055 0.7188,0.4687 0,0.5171 -0.3855,0.5626 -0.8125,0.5626 l -0.5937,0 0,-1.0313 z m 0.625,-1.6563 c -1.586,0 -2.9376,1.2221 -2.9376,2.875 0,1.665 1.3515,2.9063 2.9376,2.9063 1.564,0 2.875,-1.2411 2.875,-2.9063 0,-1.6529 -1.311,-2.875 -2.875,-2.875 z m 0,0.4688 c 1.2939,0 2.3124,1.0453 2.3124,2.4062 0,1.3842 -1.0185,2.4063 -2.3124,2.4063 -1.3161,0 -2.375,-1.0221 -2.375,-2.4063 0,-1.3609 1.0589,-2.4062 2.375,-2.4062 z" ',a+='\t\t id="path5384" ',a+='\t\t style="fill:#1870c5;fill-opacity:1;fill-rule:nonzero;stroke:none" /> ',a+="\t<path ",a+='\t\t d="m 53.797,21.252 -1.946,0 0,-7.117 1.946,0 c 2.598,0 4.666,0.856 4.666,3.513 0,2.744 -2.068,3.604 -4.666,3.604 M 32.852,26.34 c -1.03,0 -1.996,-0.188 -2.831,-0.502 l 2.803,-8.84 0.06,0 2.745,8.864 c -0.827,0.296 -1.768,0.478 -2.774,0.478 m 20.426,-17.987 -8.837,0 0,21.013 -7.72,-21.013 -7.652,0 -6.596,17.568 c -0.697,-4.428 -5.284,-5.961 -8.89,-7.104 -2.377,-0.765 -4.907,-1.889 -4.884,-3.134 0.02,-1.018 1.359,-1.962 4,-1.821 1.78,0.09 3.35,0.234 6.467,1.741 l 3.07,-5.348 C 19.395,8.802 15.454,7.89 12.23,7.883 l -0.02,0 c -3.761,0 -6.895,1.226 -8.839,3.233 -1.351,1.404 -2.082,3.18 -2.115,5.157 -0.05,2.708 0.947,4.63 3.034,6.167 1.766,1.294 4.019,2.127 6.009,2.751 2.455,0.757 4.459,1.418 4.436,2.827 -0.02,0.513 -0.211,0.994 -0.582,1.374 -0.611,0.635 -1.55,0.87 -2.849,0.899 -2.504,0.05 -4.361,-0.34 -7.319,-2.088 l -2.729,5.423 c 2.949,1.679 6.44,2.661 10.003,2.661 l 0.461,0 c 3.1,-0.06 5.604,-0.945 7.605,-2.553 l 0.324,-0.283 -0.884,2.376 8.025,0 1.348,-4.099 c 1.41,0.477 3.016,0.745 4.716,0.745 1.659,0 3.224,-0.25 4.609,-0.706 l 1.296,4.06 13.094,0 0,-8.49 2.857,0 c 6.9,0 10.986,-3.512 10.986,-9.406 0,-6.56 -3.968,-9.569 -12.416,-9.569" ',a+='\t\t id="path3100" ',a+='\t\t style="fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:none" /> ',a+="</svg>"}function copy(){(textarea=document.getElementById("IDtextarea")).select(),document.execCommand("copy")}function ResizeScreen(){wait?wait=!0:(wait=!0,setTimeout(function(){wait=!1,addhist(),parhst[ppt].Gw=Math.trunc(document.body.clientWidth-40-parhst[ppt].Hw),"graphic"==displaymode&&(parameters(),graphic())},500))}function keyfig(){"graphic"==displaymode&&(parhst[ppt].opr=document.getElementById("IDOPR").value),changex(),changey()}function changefx(){addhist(),"graphic"==displaymode&&(parhst[ppt].selfx=document.getElementById("IDFX").value),parhst[ppt].filter=document.getElementById("IDFILTER").value="",parameters(),document.title="Data Analysis - graphic refresh pending ... ",document.getElementById("IDDOT").className="dotyel"}function changeso(){addhist(),"graphic"==displaymode&&(parhst[ppt].selopt=document.getElementById("IDSO").value),parameters(),document.title="Data Analysis - graphic refresh pending ... ",document.getElementById("IDDOT").className="dotyel"}function promptfilter(){var t=document.getElementById("IDFILTER").value=prompt("Edit Filter Value",parhst[ppt].filter);parhst[ppt].filter=null==t?"":t,parameters(),document.title="Data Analysis - graphic refresh pending ... ",document.getElementById("IDDOT").className="dotyel"}function changex(){addhist(),"graphic"==displaymode&&(parhst[ppt].selx1=document.getElementById("IDX1").value),"graphic"==displaymode&&(parhst[ppt].selx2=document.getElementById("IDX2").value),"graphic"==displaymode&&(parhst[ppt].selx3=document.getElementById("IDX3").value),"graphic"==displaymode&&(parhst[ppt].selx4=document.getElementById("IDX4").value),"STK"==parhst[ppt].stsel&&(parhst[ppt].selx1==parhst[ppt].vstack&&(parhst[ppt].selx1=""),parhst[ppt].selx2==parhst[ppt].vstack&&(parhst[ppt].selx2=""),parhst[ppt].selx3==parhst[ppt].vstack&&(parhst[ppt].selx3=""),parhst[ppt].selx4==parhst[ppt].vstack&&(parhst[ppt].selx4="")),parhst[ppt].selx4!=parhst[ppt].selx3&&parhst[ppt].selx4!=parhst[ppt].selx2&&parhst[ppt].selx4!=parhst[ppt].selx1||(parhst[ppt].selx4=""),parhst[ppt].selx3!=parhst[ppt].selx2&&parhst[ppt].selx3!=parhst[ppt].selx1||(parhst[ppt].selx3=""),parhst[ppt].selx2==parhst[ppt].selx1&&(parhst[ppt].selx2="");for(var t=0;t<3;t++)""===parhst[ppt].selx1&&""!==parhst[ppt].selx2&&(parhst[ppt].selx1=parhst[ppt].selx2,parhst[ppt].selx2=""),""===parhst[ppt].selx2&&""!==parhst[ppt].selx3&&(parhst[ppt].selx2=parhst[ppt].selx3,parhst[ppt].selx3=""),""===parhst[ppt].selx3&&""!==parhst[ppt].selx4&&(parhst[ppt].selx3=parhst[ppt].selx4,parhst[ppt].selx4="");document.getElementById("IDHSTMIN").value=parhst[ppt].hstinpmin="",document.getElementById("IDHSTMAX").value=parhst[ppt].hstinpmax="",document.getElementById("IDXMIN").value=parhst[ppt].xinpmin="",document.getElementById("IDXMAX").value=parhst[ppt].xinpmax="",document.getElementById("IDYTMIN").value=parhst[ppt].ytmin="",document.getElementById("IDYTMAX").value=parhst[ppt].ytmax="",xmin=xmax="",parhst[ppt].xdtick="",parameters(),document.title="Data Analysis - graphic refresh pending ... ",document.getElementById("IDDOT").className="dotyel"}function changey(){addhist(),"graphic"==displaymode&&(parhst[ppt].sely1=document.getElementById("IDY1").value),"graphic"==displaymode&&(parhst[ppt].sely2=document.getElementById("IDY2").value),"graphic"==displaymode&&(parhst[ppt].sely3=document.getElementById("IDY3").value),"graphic"==displaymode&&(parhst[ppt].sely4=document.getElementById("IDY4").value),parhst[ppt].sely4!=parhst[ppt].sely3&&parhst[ppt].sely4!=parhst[ppt].sely2&&parhst[ppt].sely4!=parhst[ppt].sely1||(parhst[ppt].sely4=""),parhst[ppt].sely3!=parhst[ppt].sely2&&parhst[ppt].sely3!=parhst[ppt].sely1||(parhst[ppt].sely3=""),parhst[ppt].sely2==parhst[ppt].sely1&&(parhst[ppt].sely2="");for(var t=0;t<3;t++)""===parhst[ppt].sely1&&""!==parhst[ppt].sely2&&(parhst[ppt].sely1=parhst[ppt].sely2,parhst[ppt].sely2=""),""===parhst[ppt].sely2&&""!==parhst[ppt].sely3&&(parhst[ppt].sely2=parhst[ppt].sely3,parhst[ppt].sely3=""),""===parhst[ppt].sely3&&""!==parhst[ppt].sely4&&(parhst[ppt].sely3=parhst[ppt].sely4,parhst[ppt].sely4="");document.getElementById("IDYTMAX").value=parhst[ppt].ytmax="",ymax=0,document.getElementById("IDYTMIN").value=parhst[ppt].ytmin="",ymin=0,xmin=xmax="",parameters(),document.title="Data Analysis - graphic refresh pending ... ",document.getElementById("IDDOT").className="dotyel"}function changef(){addhist(),document.getElementById("IDFC").value!==parhst[ppt].selfc&&(document.getElementById("IDFACT").value=1),"graphic"==displaymode&&(parhst[ppt].selfc=document.getElementById("IDFC").value),"graphic"==displaymode&&(parhst[ppt].fact=document.getElementById("IDFACT").value),0==parhst[ppt].fact&&(parhst[ppt].fact=1,document.getElementById("IDFACT").value=parhst[ppt].fact),parhst[ppt].selfc==parhst[ppt].sely1&&(parhst[ppt].sely1="",document.getElementById("IDY1").value=parhst[ppt].sely1),parhst[ppt].selfc==parhst[ppt].sely2&&(parhst[ppt].sely2="",document.getElementById("IDY2").value=parhst[ppt].sely2),parhst[ppt].selfc==parhst[ppt].sely3&&(parhst[ppt].sely3="",document.getElementById("IDY3").value=parhst[ppt].sely3),parhst[ppt].selfc==parhst[ppt].sely4&&(parhst[ppt].sely4="",document.getElementById("IDY4").value=parhst[ppt].sely4),document.getElementById("IDYTMAX").value=parhst[ppt].ytmax="",ymax=0,document.getElementById("IDYTMIN").value=parhst[ppt].ytmin="",ymin=0,xmin=xmax="",changey()}function changevstack(){addhist(),"graphic"==displaymode&&(parhst[ppt].vstack=document.getElementById("IDVSTACK").value),""!==parhst[ppt].vstack&&""==parhst[ppt-1].vstack&&(parhst[ppt].tround=!0),"STK"==parhst[ppt].stsel&&(parhst[ppt].vstack==parhst[ppt].selx1&&(document.getElementById("IDX1").value="",changex()),parhst[ppt].vstack==parhst[ppt].selx2&&(document.getElementById("IDX2").value="",changex()),parhst[ppt].vstack==parhst[ppt].selx3&&(document.getElementById("IDX3").value="",changex()),parhst[ppt].vstack==parhst[ppt].selx4&&(document.getElementById("IDX4").value="",changex())),ymax=ymin=0,parhst[ppt].ytmax=parhst[ppt].ytmin="",document.getElementById("IDYTMAX").value="",document.getElementById("IDYTMIN").value="",stackmode()}function SAPclick(){}function getsep(){colsep=document.getElementById("IDsep").value,sspace="s"==colsep||"S"==colsep||" "==colsep}function changeparam(){var t;addhist(),"graphic"==displaymode&&(parhst[ppt].ytmin=document.getElementById("IDYTMIN").value),"graphic"==displaymode&&(parhst[ppt].ytmax=document.getElementById("IDYTMAX").value),parhst[ppt].ytmin.includes(">")?(t=parhst[ppt].ytmin.split(">"),ymin=parseFloat(t[0]),vmin=parseFloat(t[1])):(ymin=parseFloat(ymin),vmin=""),parhst[ppt].ytmax.includes("<")?(t=parhst[ppt].ytmax.split("<"),ymax=parseFloat(t[0]),vmax=parseFloat(t[1])):(ymax=parseFloat(ymax),vmax=""),"graphic"==displaymode&&(parhst[ppt].xinpmin=document.getElementById("IDXMIN").value),"graphic"==displaymode&&(parhst[ppt].hstinpmin=document.getElementById("IDHSTMIN").value),"graphic"==displaymode&&(parhst[ppt].xinpmax=document.getElementById("IDXMAX").value),"graphic"==displaymode&&(parhst[ppt].hstinpmax=document.getElementById("IDHSTMAX").value),"graphic"==displaymode&&(parhst[ppt].maxpnt=document.getElementById("IDMAXPNT").value),"graphic"==displaymode&&(parhst[ppt].dtsize=document.getElementById("IDDTSIZE").value),"graphic"==displaymode&&(parhst[ppt].avgint=document.getElementById("IDAVGINT").value),"graphic"==displaymode&&(parhst[ppt].filter=document.getElementById("IDFILTER").value),"graphic"==displaymode&&(parhst[ppt].vstack=document.getElementById("IDVSTACK").value),"graphic"==displaymode&&(parhst[ppt].opr=document.getElementById("IDOPR").value),"graphic"==displaymode&&(parhst[ppt].scnt=document.getElementById("IDSCNT").value),parameters(),document.title="Data Analysis - graphic refresh pending ... ",document.getElementById("IDDOT").className="dotyel"}function reset(){addhist(),parhst[ppt].Gw=0,document.getElementById("IDXMIN").value=parhst[ppt].xinpmin="",document.getElementById("IDXMAX").value=parhst[ppt].xinpmax="",document.getElementById("IDHSTMIN").value=parhst[ppt].hstinpmin="",document.getElementById("IDHSTMAX").value=parhst[ppt].hstinpmax="",document.getElementById("IDYTMIN").value=parhst[ppt].ytmin="",document.getElementById("IDYTMAX").value=parhst[ppt].ytmax="",parameters(),graphic()}function parameters(){var t=0,e="";if(dprev&&(p0=perfnow()),0!=data.length){if(init&&(data.length<200&&(parhst[ppt].grtype="bar",showhide(!0),gwidth=.95),init=!1,loaddefault()),start&&""==parhst[ppt].sely1)for(t=0;t<header.length;t++)if("n"==header[t][1]){parhst[ppt].sely1=t;break}if(document.getElementById("ID(C)").innerHTML="",document.getElementById("IDdata").innerHTML="",document.getElementById("IDinfo").innerHTML="",document.getElementById("IDpreview").innerHTML="",parhst[ppt].showhist&&(document.getElementById("IDhst").style.display="inline-block"),document.getElementById("IDgrp").style.display="inline-block",parhst[ppt].scnt>200&&(parhst[ppt].scnt=200),parhst[ppt].scnt<1&&(parhst[ppt].scnt=1),0==parhst[ppt].maxpnt){if("bar"==parhst[ppt].grtype){var a=sdat.length;0==a&&(a=1);var p=Math.trunc((.85*window.innerWidth-100)/(10*a));document.getElementById("IDMAXPNT").value=parhst[ppt].maxpnt=p}else data.length>1e4?parhst[ppt].maxpnt=1e4:parhst[ppt].maxpnt=data.length;document.getElementById("IDMAXPNT").value=parhst[ppt].maxpnt}0==parhst[ppt].avgint&&("bar"==parhst[ppt].grtype?parhst[ppt].avgint=Math.trunc(upt/parhst[ppt].maxpnt):((upt=Math.trunc(upt/(2*window.innerWidth)))<1&&(upt=1),parhst[ppt].avgint=upt)),displaymode="graphic",document.title="Graphic Display";var n="";if(document.getElementById("IDload").innerHTML="",document.getElementById("IDoutput").innerHTML="",!mainstyle){var s=document.createElement("style");s.id="STYLEmain",s.innerHTML="",s.innerHTML+=" input.selcol      { width:2em; height:0.8em; padding:0; margin:0; border: none; background: none; }",s.innerHTML+=" input[type='color']::-webkit-color-swatch-wrapper { padding: 0; margin: 0; }",s.innerHTML+=" input[type='color']::-webkit-color-swatch { border: solid 1px #888; }",s.innerHTML+=" .no-outline:focus { outline: none; }",s.innerHTML+=" td { padding-right: 0.2em; padding-left: 0.2em; padding-top: 0px; padding-bottom: 0px;}",s.innerHTML+=" input\t\t    { color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+";}",s.innerHTML+=" div.bgcol\t\t{ display:inline-block; background-color:gray; margin:0px; padding:0.5px; }",s.innerHTML+=" .dotred { height: 10px; width: 10px; background-color: #f00; border-radius: 50%; display: inline-block; }",s.innerHTML+=" .dotyel { height: 10px; width: 10px; background-color: #fa4; border-radius: 50%; display: inline-block; }",s.innerHTML+=" .dotgre { height: 10px; width: 10px; background-color: #282; border-radius: 50%; display: inline-block; }",document.body.appendChild(s),mainstyle=!0}for(n+="<table><tr>",n+="<td rowspan='4' valign='top'><a id='IDSAPLOGO'  title='' style='text-decoration:none' href='#' onclick='SAPclick()' >"+SAPlogo(100,50)+"</a>    <br><br><button onclick='graphic()' title='Refresh Graphic (apply pending settings) [F8]'><b>Refresh</b></button><button title='Reset Graphic' onclick='reset()'><b>RS</b></button> <span title='Status (YELLOW = refresh pending; RED = busy)' id='IDDOT' class='dotgre'></span></td>",n+="<td><div>",n+=" <b>X-Axis</b> Min/Max: <input id='IDXMIN' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"'onchange='changeparam()' type='text' name='xmin' size='17' value='"+parhst[ppt].xinpmin+"'><input id='IDXMAX' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"'onchange='changeparam()' type='text' name='xmax' size='17' value='"+parhst[ppt].xinpmax+"'>",e=" X: ",e+="<select id='IDX1' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changex()'>\n",""===parhst[ppt].selx1?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)t===parseInt(parhst[ppt].selx1)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n";for(n+=e+="</select>",e=" ",e+="<select id='IDX2' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changex()'>\n",""===parhst[ppt].selx2?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)t===parseInt(parhst[ppt].selx2)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n";for(n+=e+="</select>",e=" ",e+="<select id='IDX3' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changex()'>\n",""===parhst[ppt].selx3?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)t===parseInt(parhst[ppt].selx3)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n";for(n+=e+="</select>",e=" ",e+="<select id='IDX4' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changex()'>\n",""===parhst[ppt].selx4?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)t===parseInt(parhst[ppt].selx4)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n";for(n+=e+="</select>",n+="</div></td><td colspan=2><div>",n+="Filter: ",e="",e+="<select id='IDFX' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changefx()'>\n",""===parhst[ppt].selx2?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)t===parseInt(parhst[ppt].selfx)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n";for(n+=e+="</select>",e=" <select id='IDSO' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changeso()'>\n","=="==parhst[ppt].selopt?e+="<option value='==' selected > == </option> \n":e+="<option value='==' > == </option>","<>"==parhst[ppt].selopt?e+="<option value='<>' selected > &lt;&gt; </option> \n":e+="<option value='<>' > &lt;&gt; </option>",n+=e+="</select>",n+=" <input id='IDFILTER' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' ondblclick='promptfilter()' onchange='changeparam()' type='text' name='filter' size='17' value='"+parhst[ppt].filter+"'>",parhst[ppt].tround?n+=" <button id='IDROUND' title='round time to n seconds' style='color:black' onclick='settround()'><B>R</b></button> ":n+=" <button id='IDROUND' title='round time to n seconds' style='color:gray' onclick='settround()'>R</button> ",e="<select id='IDSROUND' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='setsround()'>\n",1==parhst[ppt].sround?e+="<option value='1' selected > 1 </option> \n":e+="<option value='1' > 1 </option>",5==parhst[ppt].sround?e+="<option value='5' selected > 5 </option> \n":e+="<option value='5' > 5 </option>",10==parhst[ppt].sround?e+="<option value='10' selected > 10 </option> \n":e+="<option value='10' > 10 </option>",15==parhst[ppt].sround?e+="<option value='15' selected > 15 </option> \n":e+="<option value='15' > 15 </option>",20==parhst[ppt].sround?e+="<option value='20' selected > 20 </option> \n":e+="<option value='20' > 20 </option>",30==parhst[ppt].sround?e+="<option value='30' selected > 30 </option> \n":e+="<option value='30' > 30 </option>",60==parhst[ppt].sround?e+="<option value='60' selected > 60 </option> \n":e+="<option value='60' > 60 </option>",120==parhst[ppt].sround?e+="<option value='120' selected > 120 </option> \n":e+="<option value='120' >120 </option>",300==parhst[ppt].sround?e+="<option value='300' selected > 300 </option> \n":e+="<option value='300' > 300 </option>",600==parhst[ppt].sround?e+="<option value='600' selected > 600 </option> \n":e+="<option value='600' > 600 </option>",900==parhst[ppt].sround?e+="<option value='900' selected > 900 </option> \n":e+="<option value='900' > 900 </option>",1200==parhst[ppt].sround?e+="<option value='1200' selected > 1200 </option> \n":e+="<option value='1200' > 1200 </option>",1800==parhst[ppt].sround?e+="<option value='1800' selected > 1800 </option> \n":e+="<option value='1800' > 1800 </option>",3600==parhst[ppt].sround?e+="<option value='3600' selected > 3600 </option> \n":e+="<option value='3600' > 3600 </option>",n+=e+="</select>",parhst[ppt].cleand?n+=" <button id='IDCLEAND' title='eliminate data points not present in all stacks' onclick='setcleand()'>E</button> ":n+=" <button id='IDCLEAND' title='add missing data points' style='color:black' onclick='setcleand()'>A</button> ",n+="</div></td>",n+="</tr>",n+="<tr>",n+="<td><div>",n+=" <b>Y-Axis</b> Min/Max: <input id='IDYTMIN' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changeparam()' type='text' size='17' name='ymin' value='"+parhst[ppt].ytmin+"'><input id='IDYTMAX' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changeparam()' type='text' size='17' name='ymax' value='"+parhst[ppt].ytmax+"'>",e=" Y: ",e+="<select id='IDY1' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changey()'>\n",""===parhst[ppt].sely1?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)"n"==header[t][1]&&(t===parseInt(parhst[ppt].sely1)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n");for(n+=e+="</select>",e=" ",e+="<select id='IDY2' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changey()'>\n",""===parhst[ppt].sely2?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)"n"==header[t][1]&&(t===parseInt(parhst[ppt].sely2)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n");for(n+=e+="</select>",e=" ",e+="<select id='IDY3' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changey()'>\n",""===parhst[ppt].sely3?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)"n"==header[t][1]&&(t===parseInt(parhst[ppt].sely3)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n");for(n+=e+="</select>",e=" ",e+="<select id='IDY4' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changey()'>\n",""===parhst[ppt].sely4?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)"n"==header[t][1]&&(t===parseInt(parhst[ppt].sely4)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n");for(n+=e+="</select>",n+="</div></td><td><div>",e="",e+="StkGrp: <select id='IDVSTACK' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changevstack()'>\n",""===parhst[ppt].vstack?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)t===parseInt(parhst[ppt].vstack)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n";for(n+=e+="</select>",n+=" <input id='IDSCNT' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changeparam()' min='0' max='9999' type='number' name='scnt' value='"+parhst[ppt].scnt+"'>",n+="</div></td><td><div>",e=" ",e+="Factor: <select id='IDFC' style='width:9em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changef()'>\n",""===parhst[ppt].selfc?e+="<option value='' selected > - </option>":e+="<option value=''> - </option>",t=0;t<header.length;t++)"n"==header[t][1]&&(t===parseInt(parhst[ppt].selfc)?e+="<option value='"+t+"' selected >"+header[t][0]+"</option> \n":e+="<option value='"+t+"'>"+header[t][0]+"</option> \n");switch(n+=e+="</select>",n+=" <input id='IDFACT' style='width:5em; color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changef()' type='number' size='6' name='fact' step='any' value='"+parhst[ppt].fact+"'>",n+="</div></td>",n+="</tr>",n+="<tr><td colspan='3'>",n+=" <b>Hist.</b>  Min/Max: <input id='IDHSTMIN'  dir='ltr' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"'onchange='changeparam()' type='text' name='hstmin' size='17' value='"+parhst[ppt].hstinpmin+"'><input id='IDHSTMAX'  dir='ltr' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"'onchange='changeparam()' type='text' name='hstmax' size='17' value='"+parhst[ppt].hstinpmax+"'>",n+=" <input id='IDco1' class='selcol' onchange='getthsval()' type='color'  value='"+parhst[ppt].colsc[0][1]+"'>",n+=" <input id='IDth1' onchange='getthsval()' type='number' style='width: 5em;' value='"+parhst[ppt].colsc[0][0]+"'>",n+=" <input id='IDco2' class='selcol' onchange='getthsval()' type='color'  value='"+parhst[ppt].colsc[1][1]+"'>",n+=" <input id='IDth2' onchange='getthsval()' type='number' style='width: 5em;' value='"+parhst[ppt].colsc[1][0]+"'>",n+=" <input id='IDco3' class='selcol' onchange='getthsval()' type='color'  value='"+parhst[ppt].colsc[2][1]+"'>",n+=" <input id='IDth3' onchange='getthsval()' type='number' style='width: 5em;' value='"+parhst[ppt].colsc[2][0]+"'>",n+=" <input id='IDco4' class='selcol' onchange='getthsval()' type='color'  value='"+parhst[ppt].colsc[3][1]+"'>",n+=" BG Color: <input id='IDbgcolor' title='Set Background Color'     class='selcol' onchange='setbgcol()' type='color' value='"+parhst[ppt].bgcolor+"'> <input id='IDchcolor' title='Set Paper Color'     class='selcol' onchange='setchcol()' type='color' value='"+parhst[ppt].chcolor+"'>",n+=" PT Color: <input id='IDptcolor' title='Set Color of Data Points' class='selcol' onchange='setptcol()' type='color' value='"+parhst[ppt].ptcolor+"'>",n+=" <input id='IDp1color' title='Set Color of Data Points' class='selcol' onchange='setptcol()' type='color' value='"+parhst[ppt].p1color+"'>",n+=" <input id='IDp2color' title='Set Color of Data Points' class='selcol' onchange='setptcol()' type='color' value='"+parhst[ppt].p2color+"'>",n+=" <input id='IDp3color' title='Set Color of Data Points' class='selcol' onchange='setptcol()' type='color' value='"+parhst[ppt].p3color+"'>",parhst[ppt].showhist?n+=" <button id='IDBHST' onclick='showhide()'>Hide Histogram</button>":n+=" <button id='IDBHST' onclick='showhide()'>Show Histogram</button>",n+="<button title='Display Data' onclick='expvdat()'>Display</button>",n+=autohide?" <a href='#' id='IDautohide' onclick='toggleautohide()'><small><i>Hide</i></small></a> ":" <a href='#' id='IDautohide' onclick='toggleautohide()'><small><i>Show</i></small></a> ",n+=" <a href='#' title='Help & Documentation' onclick='check4update()'><small><i>Help</i></small></a>  ",n+=" </td></tr>",n+=" <tr><td colspan='3'>",n+="<select id='IDGRTYPE' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='graphmode()'>\n","STK"!=parhst[ppt].stsel?("scatter"==parhst[ppt].grtype?n+="<option value='scatter' selected > Scatter </option> \n":n+="<option value='scatter'> Scatter </option> \n","bar"==parhst[ppt].grtype?n+="<option value='bar' selected > Bar </option> \n":n+="<option value='bar'> Bar </option> \n","line"==parhst[ppt].grtype?n+="<option value='line' selected > Line </option> \n":n+="<option value='line'> Line </option> \n","area"==parhst[ppt].grtype?n+="<option value='area' selected > Area </option> \n":n+="<option value='area'> Area </option> \n"):("bar"==parhst[ppt].grtype?n+="<option value='bar' selected > Bar </option> \n":n+="<option value='bar'> Bar </option> \n","area"==parhst[ppt].grtype?n+="<option value='area' selected > Area </option> \n":n+="<option value='area'> Area </option> \n","line"==parhst[ppt].grtype?n+="<option value='line' selected > Line </option> \n":n+="<option value='line'> Line </option> \n"),n+="</select>",e="","ADD"==parhst[ppt].stsel&&(e+=" <select id='IDSTSEL' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='stackmode()'>\n <option value='ADD' selected >Summarize Key Figures</option>\n <option value='STK'\t      >Stack Key Figures</option>\n",""==parhst[ppt].vstack&&(e+="<option value='IND'          >Independent Key Figures</option>\n"),e+="</select>"),"STK"==parhst[ppt].stsel&&(e+=" <select id='IDSTSEL' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='stackmode()'>\n <option value='ADD'\t       >Summarize Key Figures</option>\n <option value='STK' selected >Stack Key Figures</option>\n",""==parhst[ppt].vstack&&(e+="<option value='IND'\t        >Independent Key Figures</option>\n"),e+="</select>"),"IND"==parhst[ppt].stsel&&(e+=" <select id='IDSTSEL' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='stackmode()'>\n <option value='ADD'\t       >Summarize Key Figures</option>\n <option value='STK'          >Stack Key Figures</option>\n",""==parhst[ppt].vstack&&(e+="<option value='IND' selected >Independent Key Figures</option>\n"),e+="</select>"),n+=e,n+=" Points: <input id='IDMAXPNT' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changeparam()' min='1000' max='1000000' type='number' name='maxpnt' value='"+parhst[ppt].maxpnt+"'>",n+=" Size: <input id='IDDTSIZE' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changeparam()' min='0' max='10' type='number' name='dtsize' value='"+parhst[ppt].dtsize+"'>",n+=" Average: <input id='IDAVGINT' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='changeparam()' min='1' max='1000000' type='number' name='avgint' value='"+parhst[ppt].avgint+"'>","SUM"==parhst[ppt].opr&&(n+=" <select id='IDOPR' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='keyfig()'> <option value='SUM' selected >SUM</option> <option value='AVG'\t\t    >AVG</option> <option value='MAX'\t\t   >MAX</option> <option value='MIN'\t\t  >MIN</option></select>"),"AVG"==parhst[ppt].opr&&(n+=" <select id='IDOPR' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='keyfig()'> <option value='SUM'\t\t     >SUM</option> <option value='AVG' selected >AVG</option> <option value='MAX'\t\t   >MAX</option> <option value='MIN'\t\t  >MIN</option></select>"),"MAX"==parhst[ppt].opr&&(n+=" <select id='IDOPR' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='keyfig()'> <option value='SUM'\t\t     >SUM</option> <option value='AVG'\t\t    >AVG</option> <option value='MAX' selected >MAX</option> <option value='MIN'\t\t  >MIN</option></select>"),"MIN"==parhst[ppt].opr&&(n+=" <select id='IDOPR' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='keyfig()'> <option value='SUM'\t         >SUM</option> <option value='AVG'\t\t    >AVG</option> <option value='MAX'\t\t   >MAX</option> <option value='MIN' selected >MIN</option></select>"),parhst[ppt].smooth?n+=" <button id='IDSMOOTH' title='Add Random Decimals' style='color:black' onclick='setsmooth()'><B>ARD</b></button>":n+=" <button id='IDSMOOTH' title='Add Random Decimals' style='color:gray' onclick='setsmooth()'>ARD</button>",parhst[ppt].logdis?n+=" <button id='IDLOGDIS' title='Y-Axis: logarithmic scale' style='color:black' onclick='setlogdis()'><B>Log</b></button>":n+=" <button id='IDLOGDIS' title='Y-Axis: linear scale' style='color:gray' onclick='setlogdis()'>Lin</button>",e=" <select id='IDSSHAPE' style='color:"+parhst[ppt].fgcolor+"; background-color:"+parhst[ppt].bgcolor+"' onchange='setshape()'>\n","linear"==parhst[ppt].sshape?e+="<option value='linear' selected > linear </option> \n":e+="<option value='linear' > linear </option>","spline"==parhst[ppt].sshape?e+="<option value='spline' selected > spline </option> \n":e+="<option value='spline' > spline </option>","hvh"==parhst[ppt].sshape?e+="<option value='hvh' selected > steps </option> \n":e+="<option value='hvh' > steps </option>",n+=e+="</select>",n+=" <button id='IDbutret' style='color:gray' onclick='reprocess()'><i>go back</i></button><button title='Set Chart and Axis Title(s)' onclick='settitle()'>Title</button>",n+=" <button id='ID+' title='Increase font size' onclick='incfonts()'>+</button><button id='ID-' title='Decrease font size' onclick='decfonts()'>-</button>",n+=" <button id='IDEXP' title='Export Configuration Settings \n(hold Shift-Key to export Data Container)' onclick='expset()'>Exp.</button><button id='IDIMP' title='Import Configuration Settings \n(hold Shift-Key to import Data Container)' onclick='impset()'>Imp.</button>",n+="<button id='IDDECHST' title='revert back to previous settings' onclick='dechist()'> &lt; </button>",n+="<button id='IDLOAD' title='Load Settings' onclick='loadhist()'>Load</button>",n+="<button id='IDDEFAULT' title='Set Default Settings' onclick='savedefault()'>Default</button>",n+="<button id='IDSAVE' title='Save Settings' onclick='savehist()'>Save</button>",n+="<button id='IDINCHST' title='forward to next settings' onclick='inchist()'> &gt; </button>",n+=" </td></tr></table>",document.getElementById("IDload").innerHTML=n,document.addEventListener("keypress",onKeyPress,!1),document.addEventListener("keydown",onKeyDown,!1),document.addEventListener("keyup",onKeyUp,!1),ppt<1&&(document.getElementById("IDDECHST").disabled=!0),ppt==parhst.length-1&&(document.getElementById("IDINCHST").disabled=!0),parhst[ppt].stsel){case"ADD":case"STK":document.getElementById("IDBHST").disabled=!1;break;case"IND":document.getElementById("IDBHST").disabled=!0}""!==parhst[ppt].vstack&&(document.getElementById("IDBHST").disabled=!0,"STK"==parhst[ppt].stsel?(showhide(!0),document.getElementById("IDBHST").disabled=!0):document.getElementById("IDBHST").disabled=!1),parhst[ppt].logdis||(document.getElementById("IDYTMIN").readOnly=!1,document.getElementById("IDYTMAX").readOnly=!1),start&&graphic()}else alert("No input data specified - upload file or enter data in text area")}function onKeyPress(t){t.keyCode}function onKeyDown(t){var e=t.keyCode;119==e&&graphic(),16==e&&(keyshift=!0,document.getElementById("IDEXP").innerHTML="<b style='color:blue'>Exp.</b>")}function onKeyUp(t){16==t.keyCode&&(keyshift=!1,document.getElementById("IDEXP").innerHTML="Exp.")}function incfonts(){addhist(),parhst[ppt].cfonts+=1,parhst[ppt].afonts+=1,parhst[ppt].tfonts+=1,parameters(),graphic()}function decfonts(){addhist(),parhst[ppt].cfonts-=1,parhst[ppt].afonts-=1,parhst[ppt].tfonts-=1,parameters(),graphic()}function dechist(){(ppt-=1)<0&&(ppt=0),parhst[ppt].Gw=0,setparam(),parameters(),graphic()}function inchist(){(ppt+=1)==parhst.length&&(ppt=parhst.length-1),parhst[ppt].Gw=0,setparam(),parameters(),graphic()}function setparam(){document.getElementById("IDX1").value=parhst[ppt].selx1,document.getElementById("IDX2").value=parhst[ppt].selx2,document.getElementById("IDX3").value=parhst[ppt].selx3,document.getElementById("IDX4").value=parhst[ppt].selx4,document.getElementById("IDFX").value=parhst[ppt].selfx,document.getElementById("IDY1").value=parhst[ppt].sely1,document.getElementById("IDY2").value=parhst[ppt].sely2,document.getElementById("IDY3").value=parhst[ppt].sely3,document.getElementById("IDY4").value=parhst[ppt].sely4,document.getElementById("IDFC").value=parhst[ppt].selfc,document.getElementById("IDVSTACK").value=parhst[ppt].vstack,document.getElementById("IDXMIN").value=parhst[ppt].xinpmin,document.getElementById("IDHSTMIN").value=parhst[ppt].hstinpmin,document.getElementById("IDXMAX").value=parhst[ppt].xinpmax,document.getElementById("IDHSTMAX").value=parhst[ppt].hstinpmax,document.getElementById("IDSROUND").value=parhst[ppt].sround,document.getElementById("IDSSHAPE").value=parhst[ppt].sshape,document.getElementById("IDFILTER").value=parhst[ppt].filter,document.getElementById("IDSO").value=parhst[ppt].selopt,document.getElementById("IDSCNT").value=parhst[ppt].scnt,document.getElementById("IDYTMIN").value=parhst[ppt].ytmin,document.getElementById("IDYTMAX").value=parhst[ppt].ytmax,document.getElementById("IDFACT").value=parhst[ppt].fact,document.getElementById("IDGRTYPE").value=parhst[ppt].grtype,document.getElementById("IDSTSEL").value=parhst[ppt].stsel,document.getElementById("IDOPR").value=parhst[ppt].opr,document.getElementById("IDMAXPNT").value=parhst[ppt].maxpnt,document.getElementById("IDDTSIZE").value=parhst[ppt].dtsize,document.getElementById("IDAVGINT").value=parhst[ppt].avgint,document.getElementById("IDSMOOTH").value=parhst[ppt].smooth}function addhist(){for(var t=parhst[ppt],e=ppt+1;parhst.length>e;)parhst.pop();1==parhst[ppt].ustat&&(parhst[parhst.length]={ustat:!1,selx1:t.selx1,selx2:t.selx2,selx3:t.selx3,selx4:t.selx4,selfx:t.selfx,sely1:t.sely1,sely2:t.sely2,sely3:t.sely3,sely4:t.sely4,selfc:t.selfc,vstack:t.vstack,xinpmin:t.xinpmin,hstinpmin:t.hstinpmin,xinpmax:t.xinpmax,hstinpmax:t.hstinpmax,xdtick:t.xdtick,tround:t.tround,sround:t.sround,cleand:t.cleand,sshape:t.sshape,filter:t.filter,selopt:t.selopt,scnt:t.scnt,ytmin:t.ytmin,ytmax:t.ytmax,fact:t.fact,logdis:t.logdis,grtype:t.grtype,stsel:t.stsel,opr:t.opr,maxpnt:t.maxpnt,dtsize:t.dtsize,avgint:t.avgint,Gw:t.Gw,Hw:t.Hw,SGw:t.SGw,SHw:t.SHw,gtitle:t.gtitle,xtitle:t.xtitle,ytitle:t.ytitle,smooth:t.smooth,cfonts:t.cfonts,afonts:t.afonts,tfonts:t.tfonts,datind:t.datind,showhist:t.showhist,bgcolor:t.bgcolor,chcolor:t.chcolor,fgcolor:t.fgcolor,grcolor:t.grcolor,ptcolor:t.ptcolor,p1color:t.p1color,p2color:t.p2color,p3color:t.p3color,colsc:[[t.colsc[0][0],t.colsc[0][1]],[t.colsc[1][0],t.colsc[1][1]],[t.colsc[2][0],t.colsc[2][1]],[t.colsc[3][0],t.colsc[3][1]]]},ppt=parhst.length-1)}function toggleautohide(){autohide?(autohide=!1,document.getElementById("IDautohide").innerHTML="<small><i>Show</i></small>",sheight=.75):(autohide=!0,document.getElementById("IDautohide").innerHTML="<small><i>Hide</i></small>",sheight=.9)}function setlogdis(){addhist(),parhst[ppt].logdis?parhst[ppt].logdis=!1:parhst[ppt].logdis=!0,reset()}function setsmooth(){addhist(),parhst[ppt].smooth?parhst[ppt].smooth=!1:parhst[ppt].smooth=!0,parameters(),graphic()}function settround(){addhist(),parhst[ppt].tround?parhst[ppt].tround=!1:parhst[ppt].tround=!0,parameters(),graphic()}function setcleand(){addhist(),parhst[ppt].cleand?parhst[ppt].cleand=!1:parhst[ppt].cleand=!0,parameters(),graphic()}function setsround(){addhist(),parhst[ppt].sround=document.getElementById("IDSROUND").value,parhst[ppt].tround&&(parameters(),graphic())}function graphmode(){switch(addhist(),parhst[ppt].grtype=document.getElementById("IDGRTYPE").value,parhst[ppt].grtype){case"scatter":parhst[ppt].dtsize=3;break;case"line":parhst[ppt].dtsize=1;break;case"bar":parhst[ppt].dtsize=1,parhst[ppt].maxpnt=0;break;case"area":parhst[ppt].dtsize=1}document.getElementById("IDDTSIZE").value=parhst[ppt].dtsize,document.getElementById("IDMAXPNT").value=parhst[ppt].maxpnt,parameters(),graphic()}function stackmode(){addhist(),parhst[ppt].stsel=document.getElementById("IDSTSEL").value,changex(),document.getElementById("IDYTMIN").value="",document.getElementById("IDYTMAX").value="","ADD"==parhst[ppt].stsel?(showhide(!1),slegend=!1,"line"==parhst[ppt].grtype&&(parhst[ppt].dtsize=1),"scatter"==parhst[ppt].grtype&&(parhst[ppt].dtsize=3)):"IND"==parhst[ppt].stsel?(showhide(!0),slegend=!0,parhst[ppt].dtsize=1):"STK"==parhst[ppt].stsel&&(showhide(!1),slegend=!0,"scatter"==parhst[ppt].grtype&&(parhst[ppt].grtype="area"),parhst[ppt].dtsize=1),document.getElementById("IDGRTYPE").value=parhst[ppt].grtype,document.getElementById("IDDTSIZE").value=parhst[ppt].dtsize,parameters(),graphic()}function showhide(t=""){""!==t&&parhst[ppt].showhist!==t&&(parhst[ppt].showhist=t,addhist()),parhst[ppt].showhist?(parhst[ppt].showhist=!1,parhst[ppt].SGw=parhst[ppt].Gw,parhst[ppt].SHw=parhst[ppt].Hw):(parhst[ppt].showhist=!0,parhst[ppt].Gw=parhst[ppt].SGw,parhst[ppt].Hw=parhst[ppt].SHw),""==t&&(parameters(),graphic())}function getthsval(){addhist(),parhst[ppt].colsc[0][0]=document.getElementById("IDth1").value,parhst[ppt].colsc[1][0]=document.getElementById("IDth2").value,parhst[ppt].colsc[2][0]=document.getElementById("IDth3").value,parhst[ppt].colsc[0][1]=document.getElementById("IDco1").value,parhst[ppt].colsc[1][1]=document.getElementById("IDco2").value,parhst[ppt].colsc[2][1]=document.getElementById("IDco3").value,parhst[ppt].colsc[3][1]=document.getElementById("IDco4").value,parhst[ppt].colsc[0][0]>parhst[ppt].colsc[1][0]&&(parhst[ppt].colsc[1][0]=parseFloat(parhst[ppt].colsc[0][0])+1,parhst[ppt].colsc[1][0]=Number(parhst[ppt].colsc[1][0])),parhst[ppt].colsc[1][0]>parhst[ppt].colsc[2][0]&&(parhst[ppt].colsc[2][0]=parseFloat(parhst[ppt].colsc[1][0])+1,parhst[ppt].colsc[2][0]=Number(parhst[ppt].colsc[2][0])),parameters(),document.title="Data Analysis - graphic refresh pending ... ",document.getElementById("IDDOT").className="dotyel"}function setbgcol(){addhist(),parhst[ppt].bgcolor=document.getElementById("IDbgcolor").value,document.body.style.backgroundColor=parhst[ppt].bgcolor;var t=parhst[ppt].bgcolor.substring(1),e=parseInt(t,16);.2126*(e>>16&255)+.7152*(e>>8&255)+.0722*(e>>0&255)<100?(parhst[ppt].fgcolor="#ffffff",parhst[ppt].grcolor="#222222",parhst[ppt].ptcolor="#888888",parhst[ppt].chcolor=rgbmean(parhst[ppt].bgcolor,1.2)):(parhst[ppt].fgcolor="#222222",parhst[ppt].grcolor="#DDDDDD",parhst[ppt].ptcolor="#002E7A",parhst[ppt].chcolor=rgbmean(parhst[ppt].bgcolor,.98)),document.body.style.color=parhst[ppt].fgcolor,parameters(),graphic()}function setptcol(){addhist(),parhst[ppt].ptcolor=document.getElementById("IDptcolor").value,parhst[ppt].p1color=document.getElementById("IDp1color").value,parhst[ppt].p2color=document.getElementById("IDp2color").value,parhst[ppt].p3color=document.getElementById("IDp3color").value,parameters(),document.title="Data Analysis - graphic refresh pending ... ",document.getElementById("IDDOT").className="dotyel"}function setchcol(){addhist(),parhst[ppt].chcolor=document.getElementById("IDchcolor").value,parameters(),document.title="Data Analysis - graphic refresh pending ... ",document.getElementById("IDDOT").className="dotyel",parameters(),graphic()}function setshape(){addhist(),parhst[ppt].sshape=document.getElementById("IDSSHAPE").value,parameters(),graphic()}function convdate(t){if(void 0===convdate.date&&(convdate.date="",convdate.m=[],convdate.r="",convdate.regex=dtfrm[parhst[ppt].datind][2]),convdate.date==t)return convdate.r;convdate.date=t,convdate.m=t.match(convdate.regex);try{switch(parhst[ppt].datind){case"0":return convdate.r=convdate.m[1]+"-"+convdate.m[2]+"-"+convdate.m[3],convdate.r;case"1":return convdate.r=convdate.m[3]+"-"+convdate.m[2]+"-"+convdate.m[1],convdate.r;case"2":return convdate.r="20"+convdate.m[1]+"-"+convdate.m[2]+"-"+convdate.m[3],convdate.r;case"3":return convdate.r="20"+convdate.m[3]+"-"+convdate.m[2]+"-"+convdate.m[1],convdate.r;case"4":return convdate.r=convdate.m[1]+"-"+convdate.m[3]+"-"+convdate.m[2],convdate.r;case"5":return convdate.r=convdate.m[3]+"-"+convdate.m[1]+"-"+convdate.m[2],convdate.r;case"6":return convdate.r="20"+convdate.m[1]+"-"+convdate.m[3]+"-"+convdate.m[2],convdate.r;case"7":return convdate.r="20"+convdate.m[3]+"-"+convdate.m[1]+"-"+convdate.m[2],convdate.r}}catch(t){}}function roundtime(t,e){var a=[];if(a=t.split(":"),e){var p=3600*parseInt(a[0])+60*parseInt(a[1])+parseInt(a[2]);p=Math.trunc(p/parhst[ppt].sround)*parhst[ppt].sround,a[0]=Math.trunc(p/3600),a[1]=Math.trunc((p-3600*a[0])/60),a[2]=Math.trunc(p-3600*a[0]-60*a[1])}return pad(a[0],2)+":"+pad(a[1],2)+":"+pad(a[2],2)}function convtime(t){if(void 0===convtime.timeformat&&(convtime.timeformat=!1,convtime.pvalue="",convtime.presult=""),t==convtime.pvalue)return convtime.presult;convtime.pvalue=t;var e=/(\d{2}):(\d{2}):(\d{2})/;if(convtime.timeformat||e.test(t))return parhst[ppt].tround?(convtime.presult=roundtime(t,!0),convtime.presult):(convtime.presult=t,convtime.presult);if((e=/(\d{1,2}):(\d{1,2}):(\d{1,2})/).test(t))return parhst[ppt].tround?(convtime.presult=roundtime(t,!0),convtime.presult):(convtime.presult=roundtime(t,!1),convtime.presult);if((e=/(\d{1,2}):(\d{2}):/).test(t)){var a=t.split(":"),p=pad(a[0],2)+":"+pad(a[1],2);return parhst[ppt].tround?(convtime.presult=roundtime(p,!0),convtime.presult):(convtime.presult=roundtime(p,!1),convtime.presult)}}function rgbmean(t,e){var a=parseInt(t.slice(1),16),p=a>>16&255,n=a>>8&255,s=a>>0&255;if(0==p&&0==n&&0==s)return t;if(255==p&&255==n&&255==s)return t;var r=Math.trunc(p*e),o=Math.trunc(n*e),l=Math.trunc(s*e);return"#"+("0"+parseInt(r,10).toString(16)).slice(-2)+("0"+parseInt(o,10).toString(16)).slice(-2)+("0"+parseInt(l,10).toString(16)).slice(-2)}function rgbint(t,e){var a=parseInt(parhst[ppt].ptcolor.slice(1),16),p=parseInt(parhst[ppt].p1color.slice(1),16),n=parseInt(parhst[ppt].p2color.slice(1),16),s=parseInt(parhst[ppt].p3color.slice(1),16),r=a>>16&255,o=a>>8&255,l=a>>0&255,i=p>>16&255,d=p>>8&255,c=p>>0&255,h=n>>16&255,m=n>>8&255,u=n>>0&255,y=s>>16&255,g=s>>8&255,v=s>>0&255,f=0,x=0,I=0;return(t/=e)<.333?(t*=3,f=Math.trunc((i-r)*t+r),x=Math.trunc((d-o)*t+o),I=Math.trunc((c-l)*t+l)):t>=.333&&t<.666?(t=3*(t-.333),f=Math.trunc((h-i)*t+i),x=Math.trunc((m-d)*t+d),I=Math.trunc((u-c)*t+c)):(t=3*(t-.666),f=Math.trunc((y-h)*t+h),x=Math.trunc((g-m)*t+m),I=Math.trunc((v-u)*t+u)),"#"+("0"+parseInt(f,10).toString(16)).slice(-2)+("0"+parseInt(x,10).toString(16)).slice(-2)+("0"+parseInt(I,10).toString(16)).slice(-2)}function check4update(){window.open("https://jam4.sapjam.com/blogs/show/bavz22yEdmzrd4PHAGU3Yh")}function decnot(){"."==decpnt?(decpnt=",",document.getElementById("IDdecnot").innerHTML="Dec.Notation: 1.023.045<font style='color:red;font-size:16px;'>,</b></font>06"):","==decpnt&&(decpnt=".",document.getElementById("IDdecnot").innerHTML="Dec.Notation: 1,023,045<font style='color:red;font-size:16px;'><b>.</b></font>06")}function tabkey(t){if(9===t.keyCode&&t.shiftKey&&!t.ctrlKey&&!t.altKey){var e=document.getElementById("IDtextarea").value,a=document.getElementById("IDtextarea").selectionStart,p=document.getElementById("IDtextarea").selectionEnd;return document.getElementById("IDtextarea").value=e.substring(0,a)+"\t"+e.substring(p),document.getElementById("IDtextarea").selectionStart=document.getElementById("IDtextarea").selectionEnd=a+1,t.preventDefault(),!1}}function stack(t){t.sort(function(t,e){var a=t.s+t.x,p=e.s+e.x;return a<p?-1:a>p?1:0});var e=0,a=0;for((sdat=[])[0]={s:t[0].s,x:0},e=0;e<t.length;e++)t[e].s!==sdat[a].s&&(sdat[a+=1]={s:t[e].s,x:e});if(sdat.length>99&&(parhst[ppt].scnt=99,document.getElementById("IDSCNT").value=99),sdat.sort(function(t,e){var a=t.s,p=e.s;if(isNaN(a)||isNaN(p))return a<p?-1:a>p?1:0;var n=parseFloat(a),s=parseFloat(p);return n<s?-1:n>s?1:0}),parhst[ppt].scnt>0)for(e=sdat.length;e>0;e--)e>=parhst[ppt].scnt&&sdat.splice(e,1)}function CleanData(){if(""!==parhst[ppt].vstack&&"STK"==parhst[ppt].stsel||""!==parhst[ppt].vstack&&parhst[ppt].vstack!=parhst[ppt].selx1&&parhst[ppt].vstack!=parhst[ppt].selx2&&parhst[ppt].vstack!=parhst[ppt].selx3&&parhst[ppt].vstack!=parhst[ppt].selx4){var t=0,e=0,a=0,p=0,n=!1,s=[],r=[],o=[];if(parhst[ppt].cleand){for((s=[])[0]={x:vdat[0].x,c:0},(r=[])[0]={s:vdat[0].s,c:0},(o=[])[0]={s:vdat[0].s,c:0},p=0;p<vdat.length;p++){for(n=!1,a=0;a<o.length;a++)if(o[a].s==vdat[p].s){n=!0,o[a].c+=1;break}0==n&&(o[o.length]={s:vdat[p].s,c:1})}var l=0,i=0,d=0;for(p=0;p<o.length;p++)i+=o[p].c,d+=1;for(l=i/d,i=d=0,p=0;p<o.length;p++)(o[p].c>.8*l||o[p]<1.2*l)&&(i+=o[p].c,d+=1);for(l=i/d,p=0;o[p].c<.8*l||o[p]>1.2*l?o.splice(p,1):(o[p].c=0,p+=1),p!=o.length;);for(o.sort(function(t,e){var a=t.s,p=e.s;return a<p?-1:a>p?1:0}),p=0;p<vdat.length;p++)if(vdat[p].x==s[t].x){for(s[t].c+=1,n=!1,e=0;e<r.length;e++)if(r[e].s==vdat[p].s){n=!0;break}0==n&&(r[r.length]={s:vdat[p].s,c:0})}else JSON.stringify(r)!==JSON.stringify(o)&&(s[t].c=0),s[t+=1]={x:vdat[p].x,c:1},(r=[])[0]={s:vdat[p].s,c:0};var c=0;for(p=0;p<s.length;p++)s[p].c>c&&(c=s[p].c);for(p=0;;)if(s[p].c!==c){if(s.splice(p,1),p==s.length)break}else if((p+=1)==s.length)break;var h=0;for(t=0;;){if(vdat[h].x!==s[t].x)for(p=t;p<s.length;p++){if(vdat[h].x==s[p].x){t=p,!0;break}if(s[p].x>vdat[h].x)break}if(vdat[h].x!==s[t].x){if(vdat.splice(h,1),h==vdat.length)break}else if((h+=1)==vdat.length)break}}else{for((s=[])[0]={x:vdat[0].x,c:0},(r=[])[0]={s:vdat[0].s,c:0},(o=[])[0]={s:vdat[0].s,c:0},p=0;p<vdat.length;p++){for(n=!1,a=0;a<o.length;a++)if(o[a].s==vdat[p].s){n=!0,o[a].c+=1;break}0==n&&(o[o.length]={s:vdat[p].s,c:1})}for(o.sort(function(t,e){var a=t.s,p=e.s;return a<p?-1:a>p?1:0}),p=0;p<vdat.length;p++)vdat[p].x==s[t].x||(s[t+=1]={x:vdat[p].x,c:1});for(s.sort(function(t,e){var a=t.x,p=e.x;return a<p?-1:a>p?1:0}),t=0;t<s.length;t++)for(a=0;a<o.length;a++)((p=t*o.length+a)>vdat.length-1||vdat[p].s!==o[a].s||vdat[p].x!==s[t].x)&&vdat.splice(p,0,{s:o[a].s,x:s[t].x,c:0,y1:0,y2:0,y3:0,y4:0})}0==vdat.length&&alert("Stack values not possible - no matching x-values found"),r=null,o=null,s=null,console.log("")}}function AgregateData(){var t=0,e=[],a=0;for(a=0;a<vdat.length;a++)if(a>0&&e[t].x==vdat[a].x&&e[t].s==vdat[a].s){"MAX"==parhst[ppt].opr?(vdat[a].y1>e[t].y1&&(e[t].y1=vdat[a].y1),vdat[a].y2>e[t].y2&&(e[t].y2=vdat[a].y2),vdat[a].y3>e[t].y3&&(e[t].y3=vdat[a].y3),vdat[a].y4>e[t].y4&&(e[t].y4=vdat[a].y4)):"MIN"==parhst[ppt].opr?(vdat[a].y1<e[t].y1&&(e[t].y1=vdat[a].y1),vdat[a].y2<e[t].y2&&(e[t].y2=vdat[a].y2),vdat[a].y3<e[t].y3&&(e[t].y3=vdat[a].y3),vdat[a].y4<e[t].y4&&(e[t].y4=vdat[a].y4)):(e[t].y1+=vdat[a].y1,e[t].y2+=vdat[a].y2,e[t].y3+=vdat[a].y3,e[t].y4+=vdat[a].y4),e[t].c+=1}else a>0&&("AVG"==parhst[ppt].opr&&0!=e[t].c&&(e[t].y1=e[t].y1/e[t].c,e[t].y2=e[t].y2/e[t].c,e[t].y3=e[t].y3/e[t].c,e[t].y4=e[t].y4/e[t].c,e[t].c=0),t+=1),e[t]=vdat[a],e[t].c=1;try{e[t].c>0&&"AVG"==parhst[ppt].opr&&(e[t].y1=e[t].y1/e[t].c,e[t].y2=e[t].y2/e[t].c,e[t].y3=e[t].y3/e[t].c,e[t].y4=e[t].y4/e[t].c,e[t].c=0)}catch(t){}if(vdat=e,e=null,parhst[ppt].smooth&&vdat.length>=100){var p=0,n=[];for(a=0;a<vdat.length&&(n[p]={y:vdat[a].y1+vdat[a].y2+vdat[a].y3+vdat[a].y4},n[p].y=parseFloat(n[p].y.toPrecision(6)),p+=1,!(a>1e3));a++);n.sort(function(t,e){var a=t.y,p=e.y;return a<p?-1:a>p?1:0});var s=n[n.length-1].y-n[0].y;for(a=1;a<n.length;a++){var r=n[a].y-n[a-1].y;(r=parseFloat(r.toPrecision(6)))>0&&r<s&&(s=r)}for(s=parseFloat(s.toPrecision(6)),a=0;a<vdat.length;a++){var o=Math.random()*s;o-=s/2,Math.abs(vdat[a].y1)>=s&&(vdat[a].y1+=o),Math.abs(vdat[a].y2)>=s&&(vdat[a].y2+=o),Math.abs(vdat[a].y3)>=s&&(vdat[a].y3+=o),Math.abs(vdat[a].y4)>=s&&(vdat[a].y4+=o),0==Math.abs(vdat[a].y1)&&(vdat[a].y1+=Math.random()*s/2),0==Math.abs(vdat[a].y2)&&(vdat[a].y2+=Math.random()*s/2),0==Math.abs(vdat[a].y3)&&(vdat[a].y3+=Math.random()*s/2),0==Math.abs(vdat[a].y4)&&(vdat[a].y4+=Math.random()*s/2)}}}function BuildStackGroup(){sdat=[],""!==parhst[ppt].vstack&&stack(vdat),0==sdat.length&&(sdat[0]={s:"",y:0,x:0})}function PrepareDefaults(){if(init&&""==parhst[ppt].grtype){var t=Math.trunc(.8*window.innerWidth-100);parhst[ppt].grtype="line",lnsize=1,parhst[ppt].dtsize=1,parhst[ppt].avgint=1,parhst[ppt].maxpnt=Math.pow(10,Math.trunc(Math.log10(Math.abs(10*t)))),parhst[ppt].avgint<1&&(parhst[ppt].avgint=1),document.getElementById("IDAVGINT").value=parhst[ppt].avgint,document.getElementById("IDDTSIZE").value=parhst[ppt].dtsize,document.getElementById("IDGRTYPE").value="line",init=!1}switch(0==parhst[ppt].colsc[0][0]&&0==parhst[ppt].colsc[1][0]&&0==parhst[ppt].colsc[2][0]&&(parhst[ppt].colsc[0][0]=.75*average,parhst[ppt].colsc[0][0]=Number(parhst[ppt].colsc[0][0].toPrecision(5)),parhst[ppt].colsc[1][0]=1.25*average,parhst[ppt].colsc[1][0]=Number(parhst[ppt].colsc[1][0].toPrecision(5)),parhst[ppt].colsc[2][0]=2*average,parhst[ppt].colsc[2][0]=Number(parhst[ppt].colsc[2][0].toPrecision(5))),document.getElementById("IDth1").value=parhst[ppt].colsc[0][0],document.getElementById("IDth2").value=parhst[ppt].colsc[1][0],document.getElementById("IDth3").value=parhst[ppt].colsc[2][0],parhst[ppt].grtype){case"scatter":case"line":case"bar":filmod="none";break;case"area":filmod="STK"==parhst[ppt].stsel?"tonexty":"tozeroy"}}function LoadData(){var t=[],e=0,a=0,p=parseInt(parhst[ppt].selx1),n=parseInt(parhst[ppt].selx2),s=parseInt(parhst[ppt].selx3),r=parseInt(parhst[ppt].selx4),o=parseInt(parhst[ppt].sely1),l=parseInt(parhst[ppt].sely2),i=parseInt(parhst[ppt].sely3),d=parseInt(parhst[ppt].sely4),c=parseInt(parhst[ppt].selfc);if(""!=parhst[ppt].filter){var h=parhst[ppt].filter.split("||");for(e=0;e<h.length;e++){var m=h[e];m.includes("?")||m.includes("*")||(m="*"+m+"*"),m="^"+(m=(m=m.replace(/\?/g,".")).replace(/\*/g,".*")),t[e]=new RegExp(m)}}var u=0;for(a=0;a<data.length;a++){var y="";if(tickf="","n"==header[parhst[ppt].selx1][1]&&""==parhst[ppt].selx2&&""==parhst[ppt].selx3&&""==parhst[ppt].selx4?(y=parseFloat(data[a][p]),tickf="g"):(""!==parhst[ppt].selx1&&("d"==header[parhst[ppt].selx1][1]?y+=" "+convdate(data[a][p]):"t"==header[parhst[ppt].selx1][1]?y+=" "+convtime(data[a][p]):y+=" "+data[a][p]),""!==parhst[ppt].selx2&&("d"==header[parhst[ppt].selx2][1]?y+=" "+convdate(data[a][n]):"t"==header[parhst[ppt].selx2][1]?y+=" "+convtime(data[a][n]):y+=" "+data[a][n]),""!==parhst[ppt].selx3&&("d"==header[parhst[ppt].selx3][1]?y+=" "+convdate(data[a][s]):"t"==header[parhst[ppt].selx3][1]?y+=" "+convtime(data[a][s]):y+=" "+data[a][s]),""!==parhst[ppt].selx4&&("d"==header[parhst[ppt].selx4][1]?y+=" "+convdate(data[a][r]):"t"==header[parhst[ppt].selx4][1]?y+=" "+convtime(data[a][r]):y+=" "+data[a][r]),"t"==header[parhst[ppt].selx1][1]&&""==parhst[ppt].selx2&&""==parhst[ppt].selx3&&""==parhst[ppt].selx4&&(y=" 2000-01-01"+y,tickf="%H:%M:%S")),""!==parhst[ppt].selfx){var g=parseInt(parhst[ppt].selfx),v=""+data[a][g];if(""!=parhst[ppt].filter){var f=!1;for(e=0;e<t.length;e++)if(v.match(t[e])){f=!0;break}if("=="==parhst[ppt].selopt&&0==f)continue;if("<>"==parhst[ppt].selopt&&1==f)continue}}var x="";""!==parhst[ppt].vstack&&(x=data[a][parhst[ppt].vstack]),isNaN(x)&&(x=x.toLowerCase()),vdat[u]={s:x,x:y,c:0,y1:0,y2:0,y3:0,y4:0},"ADD"==parhst[ppt].stsel?(""===parhst[ppt].sely1||""==data[a][o]||isNaN(data[a][o])||(vdat[u].y1+=parseFloat(data[a][o])),""===parhst[ppt].sely2||""==data[a][l]||isNaN(data[a][l])||(vdat[u].y1+=parseFloat(data[a][l])),""===parhst[ppt].sely3||""==data[a][i]||isNaN(data[a][i])||(vdat[u].y1+=parseFloat(data[a][i])),""===parhst[ppt].sely4||""==data[a][d]||isNaN(data[a][d])||(vdat[u].y1+=parseFloat(data[a][d]))):"IND"!=parhst[ppt].stsel&&"STK"!=parhst[ppt].stsel||(""===parhst[ppt].sely1||""==data[a][o]||isNaN(data[a][o])||(vdat[u].y1=parseFloat(data[a][o])),""===parhst[ppt].sely2||""==data[a][l]||isNaN(data[a][l])||(vdat[u].y2=parseFloat(data[a][l])),""===parhst[ppt].sely3||""==data[a][i]||isNaN(data[a][i])||(vdat[u].y3=parseFloat(data[a][i])),""===parhst[ppt].sely4||""==data[a][d]||isNaN(data[a][d])||(vdat[u].y4=parseFloat(data[a][d]))),""!==parhst[ppt].selfc&&(isNaN(data[a][c])||(vdat[u].y1=vdat[u].y1*parseFloat(data[a][c]),vdat[u].y2=vdat[u].y2*parseFloat(data[a][c]),vdat[u].y3=vdat[u].y3*parseFloat(data[a][c]),vdat[u].y4=vdat[u].y4*parseFloat(data[a][c]))),""!==parhst[ppt].fact&&0!==parhst[ppt].fact&&(vdat[u].y1=vdat[u].y1*parseFloat(parhst[ppt].fact),vdat[u].y2=vdat[u].y2*parseFloat(parhst[ppt].fact),vdat[u].y3=vdat[u].y3*parseFloat(parhst[ppt].fact),vdat[u].y4=vdat[u].y4*parseFloat(parhst[ppt].fact)),u++}vdat.sort(function(t,e){var a=t.x+""+t.s,p=e.x+""+e.s;return a<p?-1:a>p?1:0})}function CalcMaxMinAvg(){var t=vdat[0].y1,e=[],a=0;for(a=0;a<vdat.length;a++)e=vdat[a].y1,"STK"==parhst[ppt].stsel?(""!==parhst[ppt].sely2&&(e+=vdat[a].y2),""!==parhst[ppt].sely3&&(e+=vdat[a].y3),e>t&&(t=e)):"IND"==parhst[ppt].stsel?(""!==parhst[ppt].sely1&&vdat[a].y1>t&&(t=vdat[a].y1),""!==parhst[ppt].sely2&&vdat[a].y2>t&&(t=vdat[a].y2),""!==parhst[ppt].sely3&&vdat[a].y3>t&&(t=vdat[a].y3),""!==parhst[ppt].sely4&&vdat[a].y4>t&&(t=vdat[a].y4)):e>t&&(t=e);var p=vdat[0].y1;for(a=0;a<vdat.length;a++)e=vdat[a].y1,"STK"!=parhst[ppt].stsel&&"IND"!=parhst[ppt].stsel||(""!==parhst[ppt].sely2&&vdat[a].y2<p&&(p=vdat[a].y2),""!==parhst[ppt].sely3&&vdat[a].y3<p&&(p=vdat[a].y3),""!==parhst[ppt].sely4&&vdat[a].y4<p&&(p=vdat[a].y4)),vdat[a].y1<p&&(p=vdat[a].y1);for(xmin=vdat[0].x,xmax=vdat[vdat.length-1].x,a=0;a<vdat.length;a++)0==a&&(hstmax=hstmin=vdat[a].x),vdat[a].x>hstmax&&(hstmax=vdat[a].x),vdat[a].x<hstmin&&(hstmin=vdat[a].x);""==parhst[ppt].hstinpmax?parhst[ppt].hstinpmax=hstmax:hstmax=parhst[ppt].hstinpmax,""==parhst[ppt].hstinpmin?parhst[ppt].hstinpmin=hstmin:hstmin=parhst[ppt].hstinpmin,document.getElementById("IDHSTMAX").value=parhst[ppt].hstinpmax,document.getElementById("IDHSTMIN").value=parhst[ppt].hstinpmin;var n=0;for(average=0,a=0;a<vdat.length;a++)vdat[a].x>=hstmin&&vdat[a].x<=hstmax&&("ADD"==parhst[ppt].stsel?average+=vdat[a].y1:(average+=vdat[a].y1,""!==parhst[ppt].sely2&&(average+=vdat[a].y2),""!==parhst[ppt].sely3&&(average+=vdat[a].y3),""!==parhst[ppt].sely4&&(average+=vdat[a].y4)),n+=1);average/=n;var s=Math.pow(10,Math.trunc(Math.log10(Math.abs(average))));average=parseFloat(average.toPrecision(5));var r=0,o=!0,l=!0;for(a=0;a<vdat.length;a++)if(vdat[a].x>=hstmin&&vdat[a].x<=hstmax){var i=vdat[a].y1;"ADD"==parhst[ppt].stsel?r+=Math.abs(i-average):(""!==parhst[ppt].sely2&&(i+=vdat[a].y2),""!==parhst[ppt].sely3&&(i+=vdat[a].y3),""!==parhst[ppt].sely4&&(i+=vdat[a].y4),r+=Math.abs(i-average)),i<0&&(o=!1),i>0&&(l=!1)}(r/=n,r=parseFloat(r.toPrecision(3)),"ADD"==parhst[ppt].stsel)&&((t-p)/r>10&&(p=average-2*r,o&&p<0&&(p=0),t=average+2*r,l&&t>0&&(t=0)));t==p&&(ymax=t+=1,ymin=p-=1),""==parhst[ppt].xinpmax?parhst[ppt].xinpmax=xmax:xmax=parhst[ppt].xinpmax,""==parhst[ppt].xinpmin?parhst[ppt].xinpmin=xmin:xmin=parhst[ppt].xinpmin,document.getElementById("IDXMAX").value=parhst[ppt].xinpmax,document.getElementById("IDXMIN").value=parhst[ppt].xinpmin;var d=Math.abs(t-p),c=Math.abs(average-p),h=Math.trunc(d/c/5);(0==h||d<1||c<1)&&(h=1),""!=parhst[ppt].ytmax&&(ymax=parseFloat(parhst[ppt].ytmax)),""!=parhst[ppt].ytmin&&(ymin=parseFloat(parhst[ppt].ytmin)),(""==parhst[ppt].ytmax||0==ymax||isNaN(ymax)||""==parhst[ppt].ytmin||isNaN(ymin))&&(ymax=t/h,ymin=p/h,0==(s=Math.pow(10,Math.trunc(Math.log10(Math.abs(ymax-ymin)))))&&(s=1),ymax/=s,ymax=Math.ceil(ymax),ymax*=s,ymin/=s,ymin=Math.floor(ymin),ymin*=s,""!==parhst[ppt].vstack&&"STK"==parhst[ppt].stsel&&(ymax=2*ymax*Math.sqrt(sdat.length),0==(s=Math.pow(10,Math.trunc(Math.log10(Math.abs(ymax-ymin)))))&&(s=1),ymax/=s,ymax=Math.ceil(ymax),ymax*=s),document.getElementById("IDYTMAX").value=ymax,document.getElementById("IDYTMIN").value=ymin),document.getElementById("IDdetail").innerHTML="<small> Avg: "+average.toPrecision(5)+"  Std.Dev: "+r.toPrecision(3)+"</small>"}function CalcHistogram(){var t=0,e=0,a=0,p=0,n=0,s=0,r=0;for(a=0;a<101;a++){if(t=a/100*(parseFloat(ymax)-parseFloat(ymin)),0==(n=Math.pow(10,Math.trunc(Math.log10(Math.abs(t)))))&&(n=1),n<1){var o=Math.trunc(1/n);t/=n,t=parseFloat(t.toPrecision(5))/o}else t/=n,t=parseFloat(t.toPrecision(5))*n;cntmin[a]=parseFloat(ymin)+parseFloat(t),cntlbl[a]=cntmin[a]+" ms",cntval[a]=0}for(a=0;a<101;a++)cntmax[a]=cntmin[a+1],100==a&&(cntmax[a]=100);for(a=0;a<vdat.length;a++)if(vdat[a].x>=hstmin&&vdat[a].x<hstmax)for(p=0;p<101;p++){var l=vdat[a].y1+vdat[a].y2+vdat[a].y3+vdat[a].y4;if(l>=cntmin[p]&&l<cntmax[p]){cntval[p]+=1,e+=1;break}}var i=0;for(a=0;a<101;a++)i+=cntval[a]/e*100,cntcum[a]=i;var d=0,c=0,h=0;for(a=0;a<100;a++)parseInt(cntval[a])>d&&(d=parseInt(cntval[a]),h=cntmin[a],pval=parseInt(cntval[a]),c=a);pval*=1.2;var m=0;for(a=0;a<101;a++)m+=cntval[a];m=Math.trunc(.682689*m);for(var u=cntval[c],y=c,g=c;u<=m&&(s=y,r=g,y>0&&(s=y-1),g<99&&(r=g+1),(cntval[s]>cntval[r]||99==g)&&(u+=cntval[s],y=s),(cntval[s]<=cntval[r]||0==y)&&(u+=cntval[r],g=r),0!=y||99!=g););for(FWHM=cntmin[g]-cntmin[y],FWHM=parseFloat(FWHM.toPrecision(5)),m=0,a=0;a<101;a++)m+=cntval[a];for(m=Math.trunc(.9545*m),u=cntval[c],y=c,g=c;u<=m&&(s=y,r=g,y>0&&(s=y-1),g<99&&(r=g+1),(cntval[s]>cntval[r]||99==g)&&(u+=cntval[s],y=s),(cntval[s]<=cntval[r]||0==y)&&(u+=cntval[r],g=r),0!=y||99!=g););var v=cntmin[g]-cntmin[y];for(v=parseFloat(v.toPrecision(5)),a=0;a<101;a++)cntval[a]=""+cntval[a].toFixed(0);"ADD"==parhst[ppt].stsel&&(document.getElementById("IDdetail").innerHTML+="<small>  -  Peak: "+h.toPrecision(5)+"  &sigma;: "+FWHM.toPrecision(5)+" (from: "+cntmin[y].toPrecision(3)+" to "+cntmin[g].toPrecision(3)+")  2&sigma;: "+v.toPrecision(5)+"</small>")}function CalcAverage(){if(parhst[ppt].avgint>1){var t=0,e=[],a=0,p=0;for(a=0;a<vdat.length;a++)0==t?(e[p]=vdat[a],e[p].c=1,t=1):e[p].s==vdat[a].s?(e[p].y1+=vdat[a].y1,e[p].y2+=vdat[a].y2,e[p].y3+=vdat[a].y3,e[p].y4+=vdat[a].y4,e[p].c+=1,t+=1):(e[p].y1=e[p].y1/e[p].c,e[p].y2=e[p].y2/e[p].c,e[p].y3=e[p].y3/e[p].c,e[p].y4=e[p].y4/e[p].c,e[p+=1]=vdat[a],e[p].c=1,t=1),t==parhst[ppt].avgint&&(e[p].y1=e[p].y1/e[p].c,e[p].y2=e[p].y2/e[p].c,e[p].y3=e[p].y3/e[p].c,e[p].y4=e[p].y4/e[p].c,e[p].c=0,p+=1,t=0);try{e[p].c>0&&(e[p].y1=e[p].y1/e[p].c,e[p].y2=e[p].y2/e[p].c,e[p].y3=e[p].y3/e[p].c,e[p].y4=e[p].y4/e[p].c,e[p].c=0)}catch(t){}vdat=e,e=null}}function ClipValues(){var t=0;if(""!=vmin||""!=vmax)for(t=0;t<vdat.length;t++)(""!=vmin&&vdat[t].y1<=vmin||""!=vmax&&vdat[t].y1>=vmax)&&(vdat.splice(t,1),t-=1)}function showhistogram(){var t=0;if(parhst[ppt].showhist){var e={autosize:!1,width:parhst[ppt].Hw,height:window.innerHeight*sheight,paper_bgcolor:parhst[ppt].chcolor,plot_bgcolor:parhst[ppt].chcolor,margin:{b:150,t:120,l:75,r:75},yaxis:{range:[ymin,ymax],dtick:(ymax-ymin)/20,showgrid:!0,title:"",type:"",tickfont:{size:parhst[ppt].tfonts},autorange:!1,gridcolor:parhst[ppt].grcolor},xaxis:{range:[0,105],dtick:10,domain:[0,1],showgrid:!0,tickfont:{size:parhst[ppt].tfonts},title:"",gridcolor:parhst[ppt].grcolor,margin:{b:120}},xaxis2:{domain:[0,1],range:[0,pval],overlaying:"x",showgrid:!1,tickfont:{size:parhst[ppt].tfonts},title:"",side:"top"},title:{text:"<b>Histogram - Avg.: "+average.toPrecision(3)+" (&#963;="+FWHM.toPrecision(2)+")",font:{size:parhst[ppt].cfonts}},font:{color:parhst[ppt].fgcolor},legend:{x:hlegposx,y:hlegposy,font:{family:"courier",size:parhst[ppt].tfonts,color:parhst[ppt].fgcolor}}},a={type:"scatter",mode:"lines",x:[],y:[],xaxis:"x1",yaxis:"y1",name:"% cumulated",orientation:"h",line:{size:.1,color:"lightgray"}},p={type:"bar",x:[],y:[],xaxis:"x2",yaxis:"y1",name:"< "+parhst[ppt].colsc[0][0],orientation:"h",overlaying:"x",marker:{color:parhst[ppt].colsc[0][1],width:5}},n={type:"bar",x:[],y:[],xaxis:"x2",yaxis:"y1",name:"< "+parhst[ppt].colsc[1][0],orientation:"h",overlaying:"x",marker:{color:parhst[ppt].colsc[1][1],width:5}},s={type:"bar",x:[],y:[],xaxis:"x2",yaxis:"y1",name:"< "+parhst[ppt].colsc[2][0],orientation:"h",overlaying:"x",marker:{color:parhst[ppt].colsc[2][1],width:5}},r={type:"bar",x:[],y:[],xaxis:"x2",yaxis:"y1",name:"> "+parhst[ppt].colsc[3][0],orientation:"h",overlaying:"x",marker:{color:parhst[ppt].colsc[3][1],width:5}},o=0,l=0,i=0,d=0,c=0;for(t=0;t<cntmin.length;t++)cntmin[t]<parhst[ppt].colsc[0][0]?(p.x[t]=cntval[t],p.y[t]=cntmin[t],o+=parseFloat(cntval[t])):cntmin[t]>=parhst[ppt].colsc[0][0]&&cntmin[t]<parhst[ppt].colsc[1][0]?(n.x[t]=cntval[t],n.y[t]=cntmin[t],l+=parseFloat(cntval[t])):cntmin[t]>=parhst[ppt].colsc[1][0]&&cntmin[t]<parhst[ppt].colsc[2][0]?(s.x[t]=cntval[t],s.y[t]=cntmin[t],i+=parseFloat(cntval[t])):(r.x[t]=cntval[t],r.y[t]=cntmin[t],d+=parseFloat(cntval[t])),t<100&&(c+=parseFloat(cntval[t]),a.x[t]=""+cntcum[t].toFixed(2),a.y[t]=cntmin[t]);var h=""+(o=o/c*100).toFixed(0),m=""+(l=l/c*100).toFixed(0),u=""+(i=i/c*100).toFixed(0),y=""+(d=d/c*100).toFixed(0);p.name="< "+parhst[ppt].colsc[0][0]+" - "+h+" %",n.name="< "+parhst[ppt].colsc[1][0]+" - "+m+" %",s.name="< "+parhst[ppt].colsc[2][0]+" - "+u+" %",r.name="> "+parhst[ppt].colsc[2][0]+" - "+y+" %",cntval=[],cntmin=[];var g=[a,p,n,s,r];parhst[ppt].logdis&&(e.yaxis.type="log",e.yaxis.dtick="",e.yaxis.range=[Math.log10(ymin),Math.log10(ymax)]);try{Plotly.newPlot("IDhst",g,e,{showLink:!1,showSendToCloud:!1,responsive:!0,editable:!0})}catch(t){}var v=document.getElementById("IDhst");v.on("plotly_click",function(t){}),v.on("plotly_relayout",function(t){scaleaxishist(t)})}}function graphic(){document.body.style.cursor="none",document.title="Data Analysis - calculating graphic ... ",document.getElementById("IDDOT").className="dotred",document.getElementById("IDDOT").hidden=!0,document.getElementById("IDDOT").hidden=!1,parhst[ppt].showhist?(document.getElementById("IDhstbox").style.display="inline-block",document.getElementById("IDL").style.display="inline-block",document.getElementById("IDCbox").style.display="flex",document.getElementById("IDR").style.display="inline-block",document.getElementById("IDBHST").textContent="Hide Histogram",0==parhst[ppt].Hw&&(parhst[ppt].Hw=Math.trunc(.33*(document.body.clientWidth-40))),parhst[ppt].Gw=Math.trunc(document.body.clientWidth-40-parhst[ppt].Hw)):(document.getElementById("IDhstbox").style.display="none",document.getElementById("IDL").style.display="none",document.getElementById("IDCbox").style.display="none",document.getElementById("IDR").style.display="none",document.getElementById("IDBHST").textContent="Show Histogram",parhst[ppt].Gw=Math.trunc(.95*(document.body.clientWidth-40))),0==parhst[ppt].Gw&&(parhst[ppt].Hw>0?parhst[ppt].Gw=Math.trunc(document.body.clientWidth-40-parhst[ppt].Hw):(parhst[ppt].Gw=Math.trunc((document.body.clientWidth-40)*gwidth),parhst[ppt].Hw=Math.trunc((document.body.clientWidth-40)*(1-gwidth))));var t=document.getElementById("IDhstbox"),e=document.getElementById("IDgrpbox");t.style.minWidth=parhst[ppt].Hw+"px",e.style.minWidth=parhst[ppt].Gw+"px",setTimeout(function(){var t,e=0,a=0,p=0,n=0;parhst[ppt].ustat=!0,start?start=!1:p0=perfnow(),vdat=[];var s=parseInt(parhst[ppt].selx1),r=parseInt(parhst[ppt].selx2),o=parseInt(parhst[ppt].selx3),l=parseInt(parhst[ppt].selx4),i=parseInt(parhst[ppt].sely1),d=parseInt(parhst[ppt].sely2),c=parseInt(parhst[ppt].sely3),h=parseInt(parhst[ppt].sely4);if(isNaN(s)&&isNaN(r)&&isNaN(o)&&isNaN(l))alert("Specify field(s) for X-Axis");else if(isNaN(i)&&isNaN(d)&&isNaN(c)&&isNaN(h))alert("Specify field(s) for Y-Axis");else{LoadData(),ClipValues(),AgregateData(),CleanData(),BuildStackGroup(),PrepareDefaults(),CalcMaxMinAvg(),CalcHistogram(),CalcAverage(),document.getElementById("IDgraphic").style.display="inline-block",showhistogram();var m=0;"scatter"==parhst[ppt].grtype?(chtype="scatter",chmode="markers"):"line"==parhst[ppt].grtype?(chtype="scatter",chmode="lines"):"bar"==parhst[ppt].grtype?(chtype="bar",chmode=""):"area"==parhst[ppt].grtype?(chtype="scatter",chmode="lines"):"stack"==parhst[ppt].grtype&&(chtype="scatter",chmode="lines"),"ADD"==parhst[ppt].stsel?(slegend=!1,stmode="group",sgroup0="",sgroup1="",sgroup2="",sgroup3="",lnsize=parhst[ppt].dtsize):"IND"==parhst[ppt].stsel?(slegend=!0,stmode="group",sgroup0="",sgroup1="",sgroup2="",sgroup3="",lnsize=parhst[ppt].dtsize):"STK"==parhst[ppt].stsel&&(slegend=!0,stmode="stack",chmode="lines",lnsize=parhst[ppt].dtsize,sgroup0=""!=parhst[ppt].sely1?"A":"",sgroup1=""!=parhst[ppt].sely2?"A":"",sgroup2=""!=parhst[ppt].sely3?"A":"",sgroup3=""!=parhst[ppt].sely4?"A":"");var u=new S(parhst[ppt].ptcolor,sgroup0),y=new S(parhst[ppt].p1color,sgroup1),g=new S(parhst[ppt].p2color,sgroup2),v=new S(parhst[ppt].p3color,sgroup3),f={x:[],y:[],mode:"lines",type:"scatter",showlegend:!1,line:{width:2,color:"Orange",dash:"solid"}},x={x:[],y:[],mode:"lines",type:"scatter",showlegend:!1,line:{width:2,color:"DarkOrange",dash:lntype}},I={x:[],y:[],mode:"lines",type:"scatter",showlegend:!0,name:"Average",line:{color:"gray",width:1}},D=[];""==xmin&&""==xmax&&(xmin=vdat[0].x,xmax=vdat[vdat.length-1].x,xlen=vdat[0].x.length),f.x[0]="",x.x[0]="",""==xmin&&""==xmax&&(xmin=vdat[0].x,xmax=vdat[vdat.length-1].x,xlen=vdat[0].x.length);var b=0;if(upt=vdat.length*parhst[ppt].avgint,""!==parhst[ppt].vstack){if(s=parseInt(parhst[ppt].selx1),r=parseInt(parhst[ppt].selx2),o=parseInt(parhst[ppt].selx3),l=parseInt(parhst[ppt].selx4),parhst[ppt].vstack==s||parhst[ppt].vstack==r||parhst[ppt].vstack==o||parhst[ppt].vstack==l){var E=1;try{E=vdat.length/sdat.length}catch(t){}""==parhst[ppt].xdtick&&(parhst[ppt].xdtick=E)}t={paper_bgcolor:parhst[ppt].chcolor,plot_bgcolor:parhst[ppt].chcolor,autosize:!1,width:parhst[ppt].Gw,height:window.innerHeight*sheight,barmode:stmode,margin:{b:150,t:120,l:75,r:50},yaxis:{range:[ymin,ymax],dtick:(ymax-ymin)/20,title:{text:"",font:{size:parhst[ppt].afonts}},type:"",tickfont:{size:parhst[ppt].tfonts},autorange:!1,gridcolor:parhst[ppt].grcolor},yaxis2:{gridcolor:parhst[ppt].grcolor},xaxis:{range:[xmin,xmax],gridcolor:parhst[ppt].grcolor,tickfont:{size:parhst[ppt].tfonts},dtick:parhst[ppt].xdtick,tickangle:45,domain:[0,1],title:{text:"",font:{size:parhst[ppt].afonts}},type:"-"},font:{color:parhst[ppt].fgcolor},title:{text:"<b>",font:{size:parhst[ppt].cfonts}},legend:{x:slegposx,y:slegposy,font:{family:"courier",color:parhst[ppt].fgcolor,size:parhst[ppt].tfonts}}},""!==tickf&&(t.xaxis.tickformat=tickf),D=[];var k=0;for(e=0,a=0;a<sdat.length;a++){b=0;var w={x:[],y:[],mode:chmode,type:chtype,stackgroup:sgroup0,showlegend:!0,marker:{size:parhst[ppt].dtsize,color:parhst[ppt].ptcolor},fill:filmod,name:"",line:{color:parhst[ppt].ptcolor,width:lnsize,shape:parhst[ppt].sshape}};w.marker.color=w.line.color=rgbint(a,sdat.length-1);var B=[],M=[];for((n=vdat.length/(parhst[ppt].maxpnt*sdat.length))<1&&(n=1),m=0,e=0;m=Math.trunc(e),vdat[m].s==sdat[a].s?(B[b]=vdat[m].x,M[b]=vdat[m].y1+vdat[m].y2+vdat[m].y3+vdat[m].y4,vdat[m].x>=hstmin&&vdat[m].x<=hstmax&&(I.x[k]=vdat[m].x,I.y[k]=average,k+=1),b++,e+=n):e+=1,!(e>=vdat.length););w.x=B,B=null,w.y=M,M=null,w.name=sdat[a].s,w.stackgroup=sgroup0,D.push(w),p+=w.x.length}parhst[ppt].showhist&&D.push(I),parhst[ppt].showhist&&(f.x[0]=hstmin,f.y[0]=ymin,f.x[1]=hstmin,f.y[1]=ymax,D.push(f)),parhst[ppt].showhist&&(x.x[0]=hstmax,x.y[0]=ymin,x.x[1]=hstmax,x.y[1]=ymax,D.push(x)),"d"==header[s][1]&&""==parhst[ppt].selx2||"t"==header[s][1]&&""==parhst[ppt].selx2||"d"==header[s][1]&&"n"==header[r][1]&&""==parhst[ppt].selx3||"t"==header[s][1]&&"n"==header[r][1]&&""==parhst[ppt].selx3||"d"==header[s][1]&&"t"==header[r][1]&&""==parhst[ppt].selx3?t.xaxis.type="":t.xaxis.type="category",t.title.text="<b>Data: ",""!=parhst[ppt].sely1&&(t.title.text+=" "+header[i][0]),""!=parhst[ppt].sely2&&(t.title.text+=", "+header[d][0]),""!=parhst[ppt].sely3&&(t.title.text+=", "+header[c][0]),""!=parhst[ppt].sely4&&(t.title.text+=", "+header[h][0]),t.title.text+=" </b>(Stacked by: "+header[parhst[ppt].vstack][0]+")",""!=parhst[ppt].sely1&&(u.name=header[i][0]),""!=parhst[ppt].sely2?y.name=header[d][0]:(y.name="",y.showlegend=!1,u.showlegend=!1),""!=parhst[ppt].sely3?g.name=header[c][0]:(g.name="",g.showlegend=!1),""!=parhst[ppt].sely4?v.name=header[c][0]:(v.name="",v.showlegend=!1),t.title.text+="  -  File: "+fname,""!==parhst[ppt].gtitle&&(t.title.text=parhst[ppt].gtitle),""!==parhst[ppt].xtitle&&(t.xaxis.title.text=parhst[ppt].xtitle),""!==parhst[ppt].ytitle&&(t.yaxis.title.text=parhst[ppt].ytitle),parhst[ppt].logdis&&(t.yaxis.type="log",t.yaxis.dtick="",t.yaxis.range=[Math.log10(ymin),Math.log10(ymax)]),tmptl=t.title.text;try{Plotly.newPlot("IDgrp",D,t,{showLink:!1,showSendToCloud:!1,editable:!0,responsive:!0})}catch(t){}}else{for((n=vdat.length/parhst[ppt].maxpnt)<1&&(n=1),t={paper_bgcolor:parhst[ppt].chcolor,plot_bgcolor:parhst[ppt].chcolor,autosize:!1,width:parhst[ppt].Gw,height:window.innerHeight*sheight,barmode:stmode,margin:{b:150,t:120,l:75,r:50},yaxis:{range:[ymin,ymax],dtick:(ymax-ymin)/20,title:{text:"",font:{size:parhst[ppt].afonts}},tickfont:{size:parhst[ppt].tfonts},type:"",autorange:!1,gridcolor:parhst[ppt].grcolor},yaxis2:{gridcolor:parhst[ppt].grcolor},xaxis:{range:[xmin,xmax],gridcolor:parhst[ppt].grcolor,tickangle:45,tickfont:{size:parhst[ppt].tfonts},dtick:parhst[ppt].xdtick,title:{text:"",font:{size:parhst[ppt].afonts}},domain:[0,1]},font:{color:parhst[ppt].fgcolor},title:{text:"<b>Data:",font:{size:parhst[ppt].cfonts}},legend:{x:mlegposx,y:mlegposy,font:{family:"courier",color:parhst[ppt].fgcolor,size:parhst[ppt].tfonts}}},""!==tickf&&(t.xaxis.tickformat=tickf),"d"==header[s][1]&&""==parhst[ppt].selx2||"t"==header[s][1]&&""==parhst[ppt].selx2||"d"==header[s][1]&&"n"==header[r][1]&&""==parhst[ppt].selx3||"t"==header[s][1]&&"n"==header[r][1]&&""==parhst[ppt].selx3||"d"==header[s][1]&&"t"==header[r][1]&&""==parhst[ppt].selx3?t.xaxis.type="":t.xaxis.type="category",""!=parhst[ppt].sely1&&(t.title.text+=" "+header[i][0]),""!=parhst[ppt].sely2&&(t.title.text+=" - "+header[d][0]),""!=parhst[ppt].sely3&&(t.title.text+=" - "+header[c][0]),""!=parhst[ppt].sely4&&(t.title.text+=" - "+header[h][0]),""!=parhst[ppt].sely1&&(u.name=header[i][0]),""!=parhst[ppt].sely2?y.name=header[d][0]:(y.name="",y.showlegend=!1),""!=parhst[ppt].sely3?g.name=header[c][0]:(g.name="",g.showlegend=!1),""!=parhst[ppt].sely4?v.name=header[h][0]:(v.name="",v.showlegend=!1),t.title.text+="  -  File: "+fname,""!==parhst[ppt].gtitle&&(t.title.text=parhst[ppt].gtitle),""!==parhst[ppt].xtitle&&(t.xaxis.title.text=parhst[ppt].xtitle),""!==parhst[ppt].ytitle&&(t.yaxis.title.text=parhst[ppt].ytitle),D=[u,y,g,v,f,x,I],e=0;e<vdat.length;e+=n)m=Math.trunc(e),u.x[b]=vdat[m].x,u.y[b]=vdat[m].y1,"ADD"!=parhst[ppt].stsel?(""!=parhst[ppt].sely2&&(y.x[b]=vdat[m].x,y.y[b]=vdat[m].y2),""!=parhst[ppt].sely3&&(g.x[b]=vdat[m].x,g.y[b]=vdat[m].y3),""!=parhst[ppt].sely4&&(v.x[b]=vdat[m].x,v.y[b]=vdat[m].y4)):vdat[m].x>=hstmin&&vdat[m].x<=hstmax&&(I.x[b]=vdat[m].x,I.y[b]=average),b++;parhst[ppt].showhist&&(f.x[0]=hstmin,f.y[0]=ymin,f.x[1]=hstmin,f.y[1]=ymax,D.push(f)),parhst[ppt].showhist&&(x.x[0]=hstmax,x.y[0]=ymin,x.x[1]=hstmax,x.y[1]=ymax,D.push(x)),p=u.x.length,average<=parhst[ppt].colsc[0][0]&&(I.line.color=parhst[ppt].colsc[0][1]),average>parhst[ppt].colsc[0][0]&&average<parhst[ppt].colsc[1][0]&&(I.line.color=parhst[ppt].colsc[1][1]),average>parhst[ppt].colsc[1][0]&&average<parhst[ppt].colsc[2][0]&&(I.line.color=parhst[ppt].colsc[2][1]),average>parhst[ppt].colsc[2][0]&&(I.line.color=parhst[ppt].colsc[3][1]),parhst[ppt].logdis&&(t.yaxis.type="log",t.yaxis.dtick="",t.yaxis.range=[Math.log10(ymin),Math.log10(ymax)]),tmptl=t.title.text;try{Plotly.newPlot("IDgrp",D,t,{showLink:!1,showSendToCloud:!1,editable:!0,responsive:!0})}catch(t){}}var T=document.getElementById("IDgrp");T.on("plotly_hover",function(t){evdata=t}),T.on("plotly_relayout",function(t){evdata=t}),T.on("plotly_click",function(t){0==tplclick&&setTimeout(function(){switch(tplclick){case 1:if(tplclick=0,parhst[ppt].showhist){for(var e=0;e<t.points.length;e++){var a=t.points[e].pointIndex;"min"==hsel?((hstmin=t.points[e].data.x[a])>hstmax&&(hstmax=t.points[e].data.x[t.points[e].data.x.length-1]),parhst[ppt].hstinpmin=hstmin,parhst[ppt].hstinpmax=hstmax,hsel="max",lntype="dash"):((hstmax=t.points[e].data.x[a])<hstmin&&(hstmin=t.points[e].data.x[0]),parhst[ppt].hstinpmin=hstmin,parhst[ppt].hstinpmax=hstmax,hsel="min",lntype="solid"),addhist(),document.getElementById("IDHSTMIN").value=hstmin,document.getElementById("IDHSTMAX").value=hstmax;break}parameters(),graphic()}break;case 2:var p;if(tplclick=0,"date"==t.points[0].xaxis.type?(p=t.points[0].xaxis.dtick)>144e5?(p/=36e5,p=36e5*parseInt(prompt("Enter tick distance (hours):",p)),p=9e5*Math.trunc(p/9e5)):p>6e5?(p/=6e4,p=6e4*parseInt(prompt("Enter tick distance (minutes):",p)),p=6e4*Math.trunc(p/6e4)):p>1e3?(p/=1e3,p=1e3*parseInt(prompt("Enter tick distance (seconds):",p)),p=1e3*Math.trunc(p/1e3)):p=parseInt(prompt("Enter tick distance (seconds):",p)):(p=t.points[0].xaxis.dtick,p=parseInt(prompt("Enter tick distance:",p))),p!==parhst[ppt].xdtick){addhist(),parhst[ppt].xdtick=p,parameters(),graphic();break}}tplclick=0},1e3),tplclick+=1}),T.on("plotly_relayout",function(t){scaleaxis(t)}),document.getElementById("IDdetail").innerHTML+="  -  <small> Records: "+data.length+" (total) / "+vdat.length+" (selected) / "+p+" (display) </small>",document.getElementById("js-plotly-tester").remove();document.getElementById("IDgrp").offsetHeight;setTimeout(function(){var t=((p2=perfnow())-p0-100).toFixed(2);document.body.style.cursor="crosshair",document.title="Data Analysis - Graphic calculation finished",document.getElementById("IDDOT").className="dotgre",document.getElementById("IDdetail").innerHTML+="  -  <small> Runtime: "+t+" ms  -  by (C)hristoph Weyd, SAP</small>"},25)}function S(t,e){this.x=[],this.y=[],this.mode=chmode,this.type=chtype,this.stackgroup=e,this.showlegend=slegend,this.marker={size:parhst[ppt].dtsize,color:t},this.fill=filmod,this.line={color:t,width:lnsize,shape:parhst[ppt].sshape}}},25);var a,p,n,s,r=void 0;slider||(slider=!0,Array.prototype.forEach.call(document.querySelectorAll("div.GR"),function(t){t.style.position="relative";var e=document.getElementById("IDC");e.style.cursor="col-resize",e.addEventListener("mousedown",function(e){r=t,a=e.clientX,document.getElementById("IDhstbox").style.minWidth=document.getElementById("IDhst").clientWidth+"px",document.getElementById("IDhstbox").style.minHeight=document.getElementById("IDhst").clientHeight+"px",document.getElementById("IDgrpbox").style.minWidth=document.getElementById("IDgrp").clientWidth+"px",document.getElementById("IDgrpbox").style.minHeight=document.getElementById("IDgrp").clientHeight+"px",document.getElementById("IDhst").style.display="none",document.getElementById("IDgrp").style.display="none"}),document.addEventListener("mousemove",function(t){if(r){n=t.clientX,s=n-a;var e=parhst[ppt].Hw+s,p=parhst[ppt].Gw-s,o=e/p;if(o<.2||o>2)return;document.getElementById("IDhstbox").style.minWidth=e+"px",document.getElementById("IDgrpbox").style.minWidth=p+"px"}}),document.addEventListener("click",function(t){r&&(r=void 0)}),document.addEventListener("mouseup",function(t){if(r){if(r=void 0,p=t.clientX,s=p-a,Math.abs(s)<10)return document.getElementById("IDhst").style.display="inline-block",void(document.getElementById("IDgrp").style.display="inline-block");parhst[ppt].ustat=!0,addhist(),parhst[ppt].Hw=parhst[ppt].Hw+s,parhst[ppt].Gw=parhst[ppt].Gw-s,parhst[ppt].Hw/parhst[ppt].Gw<.2&&(parhst[ppt].Gw=Math.trunc(.8*(document.body.clientWidth-40)),parhst[ppt].Hw=Math.trunc(.2*(document.body.clientWidth-40))),parhst[ppt].Hw/parhst[ppt].Gw>2&&(parhst[ppt].Gw=Math.trunc(.3333*(document.body.clientWidth-40)),parhst[ppt].Hw=Math.trunc(.6666*(document.body.clientWidth-40))),document.getElementById("IDhstbox").style.minWidth=parhst[ppt].Hw+"px",document.getElementById("IDgrpbox").style.minWidth=parhst[ppt].Gw+"px",document.getElementById("IDhst").style.display="inline-block",document.getElementById("IDgrp").style.display="inline-block",parhst[ppt].Gw=0,parameters(),graphic()}})}))}function roundscale(t,e="floor"){var a=Math.sign(t),p=0;if(0==(t*=a))return t;0==(p=t<1?Math.pow(10,Math.floor(Math.log10(t))):1)&&(p=1);var n=parseFloat(t)/p*10;return n="floor"==e?2.5*Math.floor(n/2.5)*p/10:2.5*Math.ceil(n/2.5)*p/10,n*=a}function scaleaxishist(t){JSON.parse(JSON.stringify(t),function(t,e){"legend.x"==t&&(hlegposx=e),"legend.y"==t&&(hlegposy=e)});parameters(),graphic()}function scaleaxis(t){var e="",a="",p="",n="",s=JSON.parse(JSON.stringify(t),function(t,s){return"xaxis.range[0]"==t&&(e=s),"xaxis.range[1]"==t&&(a=s),"yaxis.range[0]"==t&&(p=s),"yaxis.range[1]"==t&&(n=s),""==parhst[ppt].vstack?("legend.x"==t&&(mlegposx=s),void("legend.y"==t&&(mlegposy=s))):("legend.x"==t&&(slegposx=s),void("legend.y"==t&&(slegposy=s)))});if(JSON.stringify(t).includes("xaxis"))try{var r;xmin=e,xmin=isNaN(xmin)?" "+xmin.slice(0,xlen-1):vdat[Math.trunc(xmin)].x,xmax=a,xmax=isNaN(xmax)?" "+xmax.slice(0,xlen-1):vdat[Math.trunc(xmax)].x;var o,l="@",i="@";if(isNaN(e)){r=e,o=a;for(var d=0;d<vdat.length;d++)if(e.trim()>=vdat[d].x.trim()&&(l=""+(r=vdat[d].x)),a.trim()<=vdat[d].x.trim()){i=""+(o=vdat[d].x);break}}else{var c=evdata.xaxes[0]._vals;l=(r=c[0]).text,i=(o=c[c.length-1]).text}isNaN(r)&&(l=l.replace(/\<br\>.+/,"")),isNaN(o)&&(i=i.replace(/\<br\>.+/,"")),addhist(),"@"==l&&(l=vdat[0].x),"@"==i&&(i=vdat[vdat.length-1].x),parhst[ppt].xinpmin=xmin=l,parhst[ppt].xinpmax=xmax=i,document.getElementById("IDXMIN").value=xmin,document.getElementById("IDXMAX").value=xmax,parhst[ppt].hstinpmin<parhst[ppt].xinpmin&&(parhst[ppt].hstinpmin=parhst[ppt].xinpmin),parhst[ppt].hstinpmin>parhst[ppt].xinpmax&&(parhst[ppt].hstinpmin=parhst[ppt].xinpmin),parhst[ppt].hstinpmax>parhst[ppt].xinpmax&&(parhst[ppt].hstinpmax=parhst[ppt].xinpmax),parhst[ppt].hstinpmax<parhst[ppt].xinpmin&&(parhst[ppt].hstinpmax=parhst[ppt].xinpmax),document.getElementById("IDHSTMIN").value=hstmin,document.getElementById("IDHSTMAX").value=hstmax}catch(t){return}if(JSON.stringify(t).includes("yaxis"))try{var h=parseFloat(p),m=parseFloat(n);if(isNaN(h)||isNaN(m))return;var u=Math.sign(m);-1==u&&(m=u*parseFloat(s[0][1]),h=u*parseFloat(s[1][1])),h=roundscale(h,"floor"),m=roundscale(m-=h,"ceil")+h,-1==u?(ymin=u*m,ymax=u*h):(ymin=h,ymax=m),addhist(),parhst[ppt].logdis&&(ymax=Math.pow(10,ymax).toPrecision(6),ymin=Math.pow(10,ymin).toPrecision(6)),parhst[ppt].ytmax=""+ymax,parhst[ppt].ytmin=""+ymin,document.getElementById("IDYTMIN").value=parhst[ppt].ytmin,document.getElementById("IDYTMAX").value=parhst[ppt].ytmax}catch(t){return}parameters(),graphic()}function big(){if("graphic"==displaymode&&autohide){document.getElementById("IDparameter").style.height="12vh",document.getElementById("IDload").style.display="block",document.getElementById("IDdetail").style.display="none"}}function small(){if("graphic"==displaymode&&autohide){document.getElementById("IDparameter").style.height="1vh",document.getElementById("IDload").style.display="none",document.getElementById("IDdetail").style.display="block"}}function decsi(){"."==decpnt&&(document.getElementById("IDdecnot").innerHTML="Dec.Notation: 1 023 045<font style='color:red;font-size:16px;'><b>.</b></font>06"),","==decpnt&&(document.getElementById("IDdecnot").innerHTML="Dec.Notation: 1 023 045<font style='color:red;font-size:16px;'><b>,</b></font>06")}function decpt(){"."==decpnt&&(document.getElementById("IDdecnot").innerHTML="Dec.Notation: 1,023,045<font style='color:red;font-size:16px;'><b>.</b></font>06"),","==decpnt&&(document.getElementById("IDdecnot").innerHTML="Dec.Notation: 1.023.045<font style='color:red;font-size:16px;'><b>,</b></font>06")}function selchk(){var t=document.getElementById("IDcheckpreview");t.checked?t.checked=!1:t.checked=!0}function evtKeyDown(t){if(18==t.keyCode)try{document.getElementById("files").style.display="none",document.getElementById("btf").style.display="inline-block";var e=null;null!==(e=document.getElementById("files"))&&e.setAttribute("webkitdirectory","true")}catch{}}function evtKeyUp(t){if(18==t.keyCode)try{document.getElementById("files").style.display="inline-block",document.getElementById("btf").style.display="none";var e=null;null!==(e=document.getElementById("files"))&&e.setAttribute("webkitdirectory","false")}catch{}}function CSVToArray(t,e){e=e||",";for(var a=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),p=[[]],n=null;n=a.exec(t);){var s,r=n[1];r.length&&r!==e&&p.push([]),s=n[2]?n[2].replace(new RegExp('""',"g"),'"'):n[3],p[p.length-1].push(s)}var o=[],l="",i=0,d=0;for(i=0;i<p.length;i++){for(l="",d=0;d<p[i].length;d++)l+=p[i][d],d<p[i].length-1&&(l+="\t");o[i]=l}return o}function BuildInit(){document.title="Data Analysis";document.getElementById("myBody").innerHTML='<div id="IDparameter" onmouseover="big();"> <pre id="IDload" style="display: inline;">Select Data file(s): <button id="btf" style="width:10em;  display:none" onclick="document.getElementById(\'files\').click();">  Select Folders  </button><input type="file" title="press Alt to select folders"  accept=".xls, .dat, .dac, .txt, .csv, .mhtml, ., .xlsx, .nmon, .dzip" id="files" multiple onchange="processFiles()" /></b> </pre> </div><pre id="IDinfo" style="display: inline;"></pre><pre id="IDoutput" style="width:99vw;"></pre><pre id="IDpreview" style="overflow:scroll;"> </pre><pre id="IDdata"></pre><div onmouseover="small();"><table id="IDgraphic" style="padding: 0; margin: 0; border-collapse:collapse; display:none;"><tr><td style="padding: 0px"><div id="IDL" style="width:0px; display: inline-block;"> </div></td><td style="padding: 0px"><div id="IDhstbox"><div id="IDhst" style="display: inline-block;"></div></div></td><td style="padding: 3px"><div id="IDCbox"style="width:5px; height: 100px; display: flex; justify-content: center; align-items: center;"><div class="GR" id="IDC" style="margin: 0; border-right: 2px solid gray; border-left: 2px solid gray; height:50px; display: inline-block;"></div></div></td><td style="padding: 0px"><div id="IDgrpbox"><div id="IDgrp" style="display: inline-block;"></div></div></td><td style="padding: 0px"><div id="IDR" style="width:0px; display: inline-block;"> </div></td></tr></table></div><br><br><pre id="IDdetail"> </pre><pre id="ID(C)")><small><br><br> +++ Data.Analysis.HTML is based on open-source JavaScript charting library plotly.js v1.54.1 <a href="https://plot.ly/javascript" target="_blank">https://plot.ly/javascript/</a> - <b>(C)opyright 2012-2019, Plotly, Inc.</b>  Licensed under the MIT license (<a href="https://github.com/plotly/plotly.js" target="_blank">view the source on GitHub.</a>) +++  </small></pre>',document.body.style.backgroundColor=parhst[ppt].bgcolor,document.getElementById("IDload").innerHTML=SAPlogo(100,50)+" "+document.getElementById("IDload").innerHTML+"<small><font style='color:teal'> Column Separator: <input id='IDsep' oninput='getsep()' onchange='getsep()' type='text' maxlength='1' size='1' name='colsep' value='"+colsep+"'> (enter <b>S</B> for space; build in:<B> |;,tab/ </B>)</font></small>","."==decpnt&&(document.getElementById("IDload").innerHTML+="  <small><span id='IDdecnot' title='click to set decimal notation' onmouseover='decsi()' onmouseout='decpt()' onclick='decnot()'>Dec.Notation: 1,023,045<font style='color:red;font-size:16px;'><b>.</b></font>06</span></small>"),","==decpnt&&(document.getElementById("IDload").innerHTML+="  <small><span id='IDdecnot' title='click to set decimal notation' onmouseover='decsi()' onmouseout='decpt()' onclick='decnot()'>Dec.Notation: 1.023.045<font style='color:red;font-size:16px;'><b>,</b></font>06</span></small>"),document.getElementById("IDload").innerHTML+="  <small><font style='color:steelblue'><span onclick='selchk(event)'><i><b>check to preview data</b></i> </span><input id='IDcheckpreview' type='checkbox' style='width:12px; height:12px; margin:0px;'></small></small>",document.getElementById("IDoutput").innerHTML+="<br><br><button id='IDbutupd' onclick='update()'>Update</button>",document.getElementById("IDdata").innerHTML+="<small>Copy any column separated data to the clipboard, then paste into the text area and press <i><b>Update</b></i> button or upload files with the <i><b>Choose Files</b></i> button<br></small><br>",document.getElementById("IDdata").innerHTML+="<textarea id='IDtextarea' rows='30' cols='200' wrap='off' style='width:90vw; white-space:pre; overflow:scroll; overflow-x:scroll; overflow: -moz-scrollbars-horizontal; tabSize:30; font-family:Courier; font-size:10px; color:#000044' onkeydown='tabkey(event)' ></textarea><br>",document.getElementById("IDdata").innerHTML+="<small><i>Shift-Tab is adding tab character within text box.</i></small><br><br>",document.title="Data Analysis: select data source",document.getElementById("IDdetail").innerHTML+="<small>Data.Analysis.HTML Vers. "+prgvers+"  by Christoph Weyd ",document.addEventListener("keydown",evtKeyDown,!1),document.addEventListener("keyup",evtKeyUp,!1)}